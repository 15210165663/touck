// @charset "utf-8";
function disappearBubble(){$(".workbenchai-top-bubble").animate({opacity:0,top:0},500,function(){$(".workbenchai-top-bubble").hide()})}function timeStrConvert(a){var b=new Date(1e3*a),c=b.getFullYear(),d=b.getMonth()+1;d=d>9?d:"0"+d;var e=b.getDate();e=e>9?e:"0"+e;var f=b.getHours();f=f>9?f:"0"+f;var g=b.getMinutes();g=g>9?g:"0"+g;var h=c+"-"+d+"-"+e+" "+f+":"+g;return h}function timeFormat(a){var b=new Date,c=1e3*parseInt(a)-b.getTime(),d=parseInt(c/6e4),e=parseInt(d/1440),f=d-60*e*24,g=parseInt(f/60),h=parseInt(f-60*g);return"剩余"+e+"天"+g+"时"+h+"分"}define("text",["module"],function(a){"use strict";var b,c,d,e,f,g=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],h=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,i=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,j="undefined"!=typeof location&&location.href,k=j&&location.protocol&&location.protocol.replace(/\:/,""),l=j&&location.hostname,m=j&&(location.port||void 0),n={},o=a.config&&a.config()||{};return b={version:"2.0.14",strip:function(a){if(a){a=a.replace(h,"");var b=a.match(i);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:o.createXhr||function(){var a,b,c;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(b=0;3>b;b+=1){c=g[b];try{a=new ActiveXObject(c)}catch(d){}if(a){g=[c];break}}return a},parseName:function(a){var b,c,d,e=!1,f=a.lastIndexOf("."),g=0===a.indexOf("./")||0===a.indexOf("../");return-1!==f&&(!g||f>1)?(b=a.substring(0,f),c=a.substring(f+1)):b=a,d=c||b,f=d.indexOf("!"),-1!==f&&(e="strip"===d.substring(f+1),d=d.substring(0,f),c?c=d:b=d),{moduleName:b,ext:c,strip:e}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);return i?(f=i[2],g=i[3],g=g.split(":"),h=g[1],g=g[0],!(f&&f!==c||g&&g.toLowerCase()!==d.toLowerCase()||(h||g)&&h!==e)):!0},finishLoad:function(a,c,d,e){d=c?b.strip(d):d,o.isBuild&&(n[a]=d),e(d)},load:function(a,c,d,e){if(e&&e.isBuild&&!e.inlineText)return void d();o.isBuild=e&&e.isBuild;var f=b.parseName(a),g=f.moduleName+(f.ext?"."+f.ext:""),h=c.toUrl(g),i=o.useXhr||b.useXhr;return 0===h.indexOf("empty:")?void d():void(!j||i(h,k,l,m)?b.get(h,function(c){b.finishLoad(a,f.strip,c,d)},function(a){d.error&&d.error(a)}):c([g],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)}))},write:function(a,c,d){if(n.hasOwnProperty(c)){var e=b.jsEscape(n[c]);d.asModule(a+"!"+c,"define(function () { return '"+e+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.ext?"."+g.ext:"",i=g.moduleName+h,j=d.toUrl(g.moduleName+h)+".js";b.load(i,d,function(){var c=function(a){return e(j,a)};c.asModule=function(a,b){return e.asModule(a,j,b)},b.write(a,i,c,f)},f)}},"node"===o.env||!o.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(c=require.nodeRequire("fs"),b.get=function(a,b,d){try{var e=c.readFileSync(a,"utf8");"﻿"===e[0]&&(e=e.substring(1)),b(e)}catch(f){d&&d(f)}}):"xhr"===o.env||!o.env&&b.createXhr()?b.get=function(a,c,d,e){var f,g=b.createXhr();if(g.open("GET",a,!0),e)for(f in e)e.hasOwnProperty(f)&&g.setRequestHeader(f.toLowerCase(),e[f]);o.onXhr&&o.onXhr(g,a),g.onreadystatechange=function(){var b,e;4===g.readyState&&(b=g.status||0,b>399&&600>b?(e=new Error(a+" HTTP status: "+b),e.xhr=g,d&&d(e)):c(g.responseText),o.onXhrComplete&&o.onXhrComplete(g,a))},g.send(null)}:"rhino"===o.env||!o.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{for(c=new java.lang.StringBuffer,d=h.readLine(),d&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1)),null!==d&&c.append(d);null!==(d=h.readLine());)c.append(g),c.append(d);i=String(c.toString())}finally{h.close()}b(i)}:("xpconnect"===o.env||!o.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(d=Components.classes,e=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),f="@mozilla.org/windows-registry-key;1"in d,b.get=function(a,b){var c,g,h,i={};f&&(a=a.replace(/\//g,"\\")),h=new FileUtils.File(a);try{c=d["@mozilla.org/network/file-input-stream;1"].createInstance(e.nsIFileInputStream),c.init(h,1,0,!1),g=d["@mozilla.org/intl/converter-input-stream;1"].createInstance(e.nsIConverterInputStream),g.init(c,"utf-8",c.available(),e.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),g.readString(c.available(),i),g.close(),c.close(),b(i.value)}catch(j){throw new Error((h&&h.path||"")+": "+j)}}),b}),define("text!tpl/reward.tpl",[],function(){return'<div class="reward-container">\n	<div data-statid="c_c_ds_qx" class="reward-cancel" title="关闭"></div>\n	<input type="hidden" value="36" class="reward-value-sure">\n	<div class="tac reward-money"><span class="reward-money-value">36</span></div>\n	<div class="por reward-ofh">\n		<div class="reward-move-box clearfix">\n			<div class="fl tac reward-main">\n				<div class="por reward-rank-enter">\n					<a href="javascript:void(0);" class="bluelink rew-rank-go">本周打赏榜单</a>\n				</div>\n				<div class="reward-target">\n					<a class="avatar reward-target-avatar" target="_blank;" href="#">\n		               <img src="#">\n		            </a>\n		            <span class="c777 reward-target-name"></span>\n				</div>\n				<div class="c444 reward-txt">这是我对Ta的支持</div>\n		        <div class="reward-cho-con">\n		       		<div class="reward-cho-anim">\n						<div class="reward-cho-box">\n							<div class="redtext reward-cho-value">\n								<span>8</span>\n								<span>16</span>\n								<span>36</span>\n								<span>66</span>\n								<span>99</span>\n								<span>199</span>\n							</div>\n							<div class="reward-cho-pro clearfix">\n								<a href="javascript:void(0);" class="reward-cho-sym"></a>\n								<a href="javascript:void(0);" data-statid="c_c_ds_8" class="reward-cho-btn btn-first" value="8"></a>\n								<a href="javascript:void(0);" data-statid="c_c_ds_16" class="reward-cho-btn" value="16"></a>\n								<a href="javascript:void(0);" data-statid="c_c_ds_36" class="reward-cho-btn cho" value="36"></a>\n								<a href="javascript:void(0);" data-statid="c_c_ds_66" class="reward-cho-btn" value="66"></a>\n								<a href="javascript:void(0);" data-statid="c_c_ds_99" class="reward-cho-btn" value="99"></a>\n								<a href="javascript:void(0);" data-statid="c_c_ds_199" class="reward-cho-btn btn-last" value="199"></a>\n							</div>\n							<div class="cho-other">\n								<a href="javascript:void(0);" data-statid="c_c_ds_qtje" class="bluelink cho-other-btn">其他金额</a>\n							</div>\n						</div>\n						<div class="reward-cho-self">\n							<div class="cho-self-box">\n								<input type="text" class="input tac redtext reward-input" maxLength="3">\n								<span class="c777">&nbsp;&nbsp;元&nbsp;&nbsp;输入1~199的金额</span>\n							</div>\n							<div class="cho-other">\n								<a href="javascript:void(0);" data-statid="c_c_ds_jeqh" class="bluelink cho-local-btn">切换回金额选择</a>\n							</div>\n						</div>\n					</div>\n				</div>\n				<div class="reward-sub">\n					<a href="javascript:void(0);" data-statid="c_c_ljds" class="redbg btn reward-sub-btn">立即打赏</a>\n				</div>\n				<div class="reward-remind">\n					<span class="c999">打赏无悔，概不退款</span>\n				</div>\n			</div>\n		</div>\n	</div>\n	\n	<div class="tac reward-ing-main" style="display:none;">\n		<div class="reward-ing-txt">\n			支付完成前<br/>请不要关闭此窗口\n		</div>\n		<div class="reward-ing-btn">\n			<a href="javascript:void(0);" data-statid="c_c_ds_wczf" class="bluebg btn reward-done">已完成支付</a>\n			<a href="javascript:void(0);" data-statid="c_c_ds_jxzf" class="bluebg btn reward-continue">继续支付</a>\n		</div>\n		<div class="reward-ing-remind">\n			<p>支付遇到问题，请联系客服</p>\n			<p>0571-56768855</p>\n		</div>\n	</div>\n</div>;'}),define("reward",["text!tpl/reward.tpl"],function(a){function b(){$("body").on("mouseenter",".reward-btn-box",function(){$(this).find(".reward-btn").hide(),$(this).find(".reward-btn-in").show()}),$("body").on("mouseleave",".reward-btn-box",function(){$(this).find(".reward-btn").show(),$(this).find(".reward-btn-in").hide()}),$("body").on("mouseenter",".reward-in-box",function(){$(this).find(".reward-btn").hide(),$(this).find(".reward-btn-in").show()}),$("body").on("mouseleave",".reward-in-box",function(){$(this).find(".reward-btn").show(),$(this).find(".reward-btn-in").hide()}),$("body").on("click",".reward-btn-in",function(){if(!SNS.getUserid())return $("#J_Login").trigger("click"),!1;var b=$(this),d=SNS.strToObject(b.attr("data-action")),g={data:{dialogClass:"",newTpl:a,width:316},effect:{showStyle:"",effectDuration:1e3},showMask:"true",afershowCallback:function(a){a.find(".ui-dialog-close").hide(),a.css("box-shadow","none"),a.find(".ui-dialog").css("background","none"),"3"!==d.rewtype&&a.find(".reward-rank-enter").remove(),"3"===d.rewtype&&"1"===$(".glo-param").attr("data-owner")?(a.find(".reward-main").hide(),f(a,0)):c(b,a,d),e(a)}};return new SNS.Dialog(g),!1})}function c(a,b,c){var e=b.find(".reward-cho-self .reward-input"),f=b.find(".reward-cho-anim"),h=b.find(".reward-cho-btn"),i=b.find(".reward-value-sure");b.find(".reward-target-avatar").attr("href",c.rewlink),b.find(".reward-target-avatar img").attr("src",c.rewavatar),b.find(".reward-target-name").html(c.rewname),b.find(".reward-cancel").click(function(){b.find(".ui-dialog-close").trigger("click")}),b.find(".reward-money-value").stop().animate({top:"0"},400),h.mouseenter(function(a){var c=$(a.target),d=c.position().left,e=0;e=c.hasClass("btn-first")?d:d+15,b.find(".reward-cho-sym").stop().animate({left:e+"px"},200)}),h.mouseleave(function(){var a=b.find(".cho"),c=a.position().left,d=0;d=a.hasClass("btn-first")?c:c+15,b.find(".reward-cho-sym").stop().animate({left:d+"px"},200)}),h.click(function(){var a=b.find(".reward-money-value"),c=$(this),d=c.attr("value");i.val(d),$(".reward-cho-btn").removeClass("cho"),c.addClass("cho"),a.stop().animate({top:"60px"},400,function(){$(this).remove(),$(".reward-money").prepend('<span class="reward-money-value">'+d+"</span>"),b.find(".reward-money-value").stop().animate({top:"0"},400)})}),b.find(".cho-other-btn").click(function(){f.stop().animate({top:"-73px"},500,function(){e.focus()})}),b.find(".cho-local-btn").click(function(){f.stop().animate({top:0},500),e.val("")}),e.keyup(function(){var a=$.trim($(this).val());$(this).val(a.replace(/\D|^0/g,""))}).bind("paste",function(){var a=$.trim($(this).val());$(this).val(a.replace(/\D|^0/g,""))}).css("img-mode","disabled"),e.blur(function(){var a=b.find(".reward-money-value"),c=$.trim($(this).val()),d=new RegExp("^[1-9]*[1-9][0-9]*$");d.test(c)?i.val()!=c&&(i.val(c),a.stop().animate({top:"60px"},400,function(){$(this).remove(),$(".reward-money").prepend('<span class="reward-money-value">'+c+"</span>"),b.find(".reward-money-value").stop().animate({top:"0"},400)})):$(this).val("")}),b.find(".reward-sub-btn").click(function(){if(g===!0)return!1;var a=i.val();if(parseInt(a)>199)return SNS.alertBox({type:"error",tipContent:"打赏金额不能超过199元"}),!1;var d={sellerid:c.sellerid,targetid:c.targetid,targettype:c.rewtype,money:a};g=!0,$.ajax({url:"/newcircle/reward/reward/",type:"GET",data:d,async:!1,dataType:"json",success:function(a){0===a.errorCode?(b.find(".reward-ofh").hide(),b.find(".reward-ing-main").show(),window.open(a.payurl),b.find(".reward-ing-btn").attr("key",a.key)):SNS.alertBox({type:"error",tipContent:a.errorMsg})},error:function(){SNS.alertBox({type:"error",tipContent:"服务器偷了个小懒"})},complete:function(){g=!1}})}),b.on("click",".reward-done",function(){var c=$(this).parents(".reward-ing-btn").attr("key"),e={ingCallBack:function(){var a='<div class="tac reward-check-main">	<div class="reward-ing-txt">		支付确认中	</div>	<div class="c777 reward-check-txt">		如果您已收到扣款信息<br/>请不要重复支付	</div>	<div class="reward-check-btn">		<a href="javascript:void(0);" class="bluebg btn reward-close">确&nbsp;&nbsp;定</a>	</div>	<div class="reward-ing-remind">		<p>支付遇到问题，请联系客服</p>		<p>0571-56768855</p>	</div></div>';b.find(".reward-ofh").remove(),b.find(".reward-ing-main").remove(),b.find(".reward-container").append(a),b.on("click",".reward-close",function(){b.find(".ui-dialog-close").trigger("click")})},orderKey:c,async:!0};d(a,b,e)}),b.on("click",".reward-continue",function(){var c=$(this).parents(".reward-ing-btn").attr("key"),e={ingCallBack:function(){b.find(".reward-sub-btn").trigger("click")},orderKey:c,async:!1};d(a,b,e)})}function d(a,b,c){if(h===!0)return!1;var d={key:c.orderKey};h=!0,$.ajax({url:"/newcircle/reward/checkReward/",type:"GET",data:d,async:c.async,dataType:"json",success:function(d){if(0===d.errorCode){var e='<div class="tac reward-success-main">	<div class="redtext reward-ing-txt">		恭喜您，打赏成功！	</div>	<div class="c777 reward-check-txt">		谢谢您对Ta的支持	</div>	<div class="reward-success-btn">		<a href="javascript:void(0);" class="bluebg btn reward-close">确&nbsp;&nbsp;定</a>	</div></div>';b.find(".reward-ofh").remove(),b.find(".reward-ing-main").remove(),b.find(".reward-container").append(e),b.on("click",".reward-close",function(){b.find(".ui-dialog-close").trigger("click")});var f=SNS.strToObject(a.attr("data-action"));if(1==f.rewtype||5==f.rewtype||6==f.rewtype){var g=a.parents(".reward-post-box"),h=SNS.strToObject(g.attr("data-action")),i=0,j=parseInt(h.rewnum),k='<div class="tac reward-user-box"><a class="avatar" target="_blank;" href="'+h.userPage+'"><img src="'+h.userAvator+'"></a></div>',l='<a class="avatar" target="_blank;" href="'+h.userPage+'"><img usercard="userid='+SNS.getUserid()+'" src="'+h.userAvator+'"></a>',m=g.find(".reward-user-box .avatar").length;0===m?(g.append('<div class="tac fz14 c777 reward-post-num">1次赞赏</div>'),g.append(k)):m>0&&10>m?(i=j+1,g.find(".reward-post-num").html(i+"次赞赏"),g.find(".reward-user-box").prepend(l)):m>=10&&(i=j+1,g.find(".reward-post-num").html(i+"次赞赏"),g.find(".reward-user-box .avatar").last().remove(),g.find(".reward-user-box").prepend(l))}if(a.parent().find(".reward-num").length>0){var n=parseInt($.trim(a.find(".reward-num").html())),o=n+1;a.parent().find(".reward-num").html(o),a.attr("title",o+"次赞赏")}}else-21==d.errorCode?c.ingCallBack():SNS.alertBox({type:"error",tipContent:d.errorMsg})},error:function(){SNS.alertBox({type:"error",tipContent:"服务器偷了个小懒"})},complete:function(){h=!1}})}function e(a){a.find(".rew-rank-go").click(function(){return a.find(".reward-rank-main").length>=1?(a.find(".reward-move-box").stop().animate({right:300},500),!1):void f(a,1)})}function f(a,b){if(i===!0)return!1;var c={fid:$(".left-chat-list").attr("data-fid")};i=!0,$.ajax({url:"/newcircle/reward/getCircleRewardRank/",type:"GET",data:c,dataType:"json",success:function(c){0===c.errorCode?(a.find(".reward-move-box").append(c.rankData),a.find(".rew-rank-back").click(function(){a.find(".reward-move-box").stop().animate({right:0},500)}),1===b?a.find(".reward-move-box").stop().animate({right:300},500):0===b&&(a.find(".rank-empty-text").html("本周暂无打赏"),a.find(".rew-rank-back").hide(),a.find(".reward-money-value").html(c.total).stop().animate({top:"0"},400),a.find(".reward-cancel").click(function(){a.find(".ui-dialog-close").trigger("click")}))):SNS.alertBox({type:"error",tipContent:c.errorMsg})},error:function(){SNS.alertBox({type:"error",tipContent:"服务器偷了个小懒"})},complete:function(){i=!1}})}var g=!1,h=!1,i=!1;$(document).ready(function(){b()})}),define("usercard",["reward"],function(){function a(){return this.init()}a.prototype.init=function(){this.bindEvent()},a.prototype.bindEvent=function(){var a=this;$("body").delegate("[usercard]","mouseenter",function(b){a.triggerEle=$(b.currentTarget);var c=SNS.strToObject(a.triggerEle.attr("usercard")).userid;if($("#usercard"+c).length)a.showUserCard(c);else{var d={userid:c};a.ajax(d)}}),$("body").delegate("[usercard]","mouseleave",function(b){a.show&&clearTimeout(a.show),a.triggerEle=$(b.currentTarget),a.hide=setTimeout(function(){$(".usercard").hide()},300)}),$("body").delegate(".usercard","mouseenter",function(){a.hide&&clearTimeout(a.hide)}),$("body").delegate(".usercard","mouseleave",function(){a.hide=setTimeout(function(){a.contentEle.hide()},300)}),$("body").delegate('[follow="usercard-cancelfollow"]',"mouseenter",function(){$(this).empty().html("取消关注")}),$("body").delegate('[follow="usercard-cancelfollow"]',"mouseleave",function(){$(this).empty().append('<i class="icon-nofollow png"></i><span>已关注</span>')}),$("body").delegate(".usercard-relation","click",function(a){var b,c=SNS.strToObject($(a.currentTarget).attr("data-follow-action")).follow,d=this;return"usercard-follow"==$(this).attr("follow")?(b=SNS.strToObject($(this).attr("data-follow-action")),SNS.follow({follow:c,oData:b,success:function(){$(d).attr("title","取消关注"),$(d).attr("follow","usercard-cancelfollow"),$(d).removeClass("redbg").addClass("graybg"),$(d).empty().append('<i class="icon-nofollow png"></i><span>已关注</span>'),TA.log({id:"c_c_xxk_gz",fid:"sns_c_fol"})}})):"usercard-cancelfollow"==$(this).attr("follow")&&(b=SNS.strToObject($(this).attr("data-calcelfollow-action")),SNS.cancelfollow({follow:c,oData:b,success:function(){$(d).attr("title","关注Ta"),$(d).attr("follow","usercard-follow"),$(d).removeClass("graybg").addClass("redbg"),$(d).empty().append('<i class="icon-follow png"></i><span>加关注</span>'),TA.log({id:"c_c_xxk_qxgz"})}})),!1}),$("body").delegate(".usercard","click",function(a){var b,c=$(a.target);b=c.closest(".usercard-t").length?c.closest(".usercard-t").attr("newurl"):$(a.currentTarget).attr("newurl"),b.length>0&&window.open(b)})},a.prototype.ajax=function(a){var b=this;$.ajax({url:"/newcircle/user/usercard/",data:a,type:"get",dataType:"json",cache:!1,beforeSend:function(){},success:function(c){0===c.errorCode?($(c.result).appendTo("body"),b.contentEle=$("#usercard"+a.userid)):SNS.alertBox({type:"error",tipContent:c.errorMsg})},error:function(){}}),b.showUserCard(a.userid)},a.prototype.setPosition=function(){var a,b,c,d=this,e=d.triggerEle.offset().left,f=d.triggerEle.offset().top,g=d.triggerEle.outerWidth(),h=d.triggerEle.outerHeight(),i=$(window).scrollTop(),j=$(window).width(),k=$(window).height(),l=110,m=12,n=233,o=367;j-e-g-m>=n?b=g+e+m:(b=e-m-n,d.contentEle.find(".usercard-arrowleft").addClass("usercard-arrowright")),f+h/2+o-l>i+k?(c=i+k-o,a=f+h/2+o-l-(i+k)+100):(c=f+h/2-l,a=100),d.contentEle.css({position:"absolute",left:b,top:c}),d.contentEle.find(".triangle").css({top:a})},a.prototype.showUserCard=function(a){var b=this;b.hide=setTimeout(function(){$(".usercard").hide()},300),b.show=setTimeout(function(){b.contentEle=$("#usercard"+a),b.setPosition(),b.contentEle.show()},500),TA.log({id:"c_p_xxk"})},$(document).ready(function(){SNS.getUserid()&&new a})}),define("tinyscrollbar",[],function(){!function(a){"use strict";function b(b,e){function f(){return o.update(),h(),o}function g(){t.css(y,o.thumbPosition),a(q[0]).css(y,-o.contentPosition),r.css(x,o.trackSize),s.css(x,o.trackSize),t.css(x,o.thumbSize)}function h(){u?p[0].ontouchstart=function(a){1===a.touches.length&&(a.stopPropagation(),k(a.touches[0]))}:(t.bind("mousedown",function(a){a.stopPropagation(),k(a)}),s.bind("mousedown",function(a){k(a,!0)})),a(window).resize(function(){o.update("relative")}),o.options.wheel&&window.addEventListener?b[0].addEventListener(v,l,!1):o.options.wheel&&(b[0].onmousewheel=l),b.on("mouseenter mouseleave",function(a){"mouseenter"==a.type?t.fadeIn(300):t.fadeOut(300)})}function i(){return o.contentPosition>0}function j(){return o.contentPosition<=o.contentSize-o.viewportSize-5}function k(b,c){o.hasContentToSroll&&(a("body").addClass("noSelect"),z=c?t.offset()[y]:w?b.pageX:b.pageY,u?(document.ontouchmove=function(a){(o.options.touchLock||i()&&j())&&a.preventDefault(),m(a.touches[0])},document.ontouchend=n):(a(document).bind("mousemove",m),a(document).bind("mouseup",n),t.bind("mouseup",n),s.bind("mouseup",n)),m(b))}function l(c){if(o.hasContentToSroll){var d=c||window.event,e=-(d.deltaY||d.detail||-1/3*d.wheelDelta)/40,f=1===d.deltaMode?o.options.wheelSpeed:1;o.contentPosition-=e*f*o.options.wheelSpeed,o.contentPosition=Math.min(o.contentSize-o.viewportSize,Math.max(0,o.contentPosition)),o.thumbPosition=o.contentPosition/o.trackRatio,b.trigger("move"),t.css(y,o.thumbPosition),a(q[0]).css(y,-o.contentPosition),(o.options.wheelLock||i()&&j())&&(d=a.event.fix(d),d.preventDefault())}}function m(c){if(o.hasContentToSroll){clearTimeout(o.animate_scrollbar),t.stop(!0,!0).css({opacity:.5});var d=w?c.pageX:c.pageY,e=u?z-d:d-z,f=Math.min(o.trackSize-o.thumbSize,Math.max(0,o.thumbPosition+e));o.contentPosition=f*o.trackRatio,b.trigger("move"),t.css(y,f),a(q[0]).css(y,-o.contentPosition)}}function n(){o.thumbPosition=parseInt(t.css(y),10)||0,a("body").removeClass("noSelect"),a(document).unbind("mousemove",m),a(document).unbind("mouseup",n),t.unbind("mouseup",n),s.unbind("mouseup",n),document.ontouchmove=document.ontouchend=null,o.animate_scrollbar=setTimeout(function(){t.animate({opacity:.2},500)},1e3)}this.options=a.extend({},d,e),this._defaults=d,this._name=c;var o=this,p=b.find(".viewport"),q=b.find(".overview"),r=b.find(".scrollbar").eq(0),s=r.find(".track").eq(0),t=r.find(".thumb").eq(0),u="ontouchstart"in document.documentElement,v="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",w="x"===this.options.axis,x=w?"width":"height",y=w?"left":"top",z=0;return this.contentPosition=0,this.viewportSize=0,this.contentSize=0,this.contentRatio=0,this.trackSize=0,this.trackRatio=0,this.thumbSize=0,this.thumbPosition=0,this.hasContentToSroll=!1,this.animate_scrollbar,this.update=function(a){var b=x.charAt(0).toUpperCase()+x.slice(1).toLowerCase();switch(this.viewportSize=p[0]["offset"+b],this.contentSize=q[0]["scroll"+b],this.contentRatio=this.viewportSize/this.contentSize,this.trackSize=this.options.trackSize||this.viewportSize,this.thumbSize=Math.min(this.trackSize,Math.max(this.options.thumbSizeMin,this.options.thumbSize||this.trackSize*this.contentRatio)),this.trackRatio=(this.contentSize-this.viewportSize)/(this.trackSize-this.thumbSize),this.hasContentToSroll=this.contentRatio<1,r.toggleClass("disable",!this.hasContentToSroll),a){case"bottom":this.contentPosition=Math.max(this.contentSize-this.viewportSize,0);break;case"relative":this.contentPosition=Math.min(Math.max(this.contentSize-this.viewportSize,0),Math.max(0,this.contentPosition));break;default:this.contentPosition=parseInt(a,10)||0}return this.thumbPosition=this.contentPosition/this.trackRatio,g(),o},f()}var c="tinyscrollbar",d={axis:"y",wheel:!0,wheelSpeed:40,wheelLock:!0,touchLock:!0,trackSize:!1,thumbSize:!1,thumbSizeMin:20};a.fn[c]=function(d){return this.each(function(){a.data(this,"plugin_"+c)||a.data(this,"plugin_"+c,new b(a(this),d))})}}($)}),!function(){function a(a){return a.replace(t,"").replace(u,",").replace(v,"").replace(w,"").replace(x,"").split(y)}function b(a){return"'"+a.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function c(c,d){function e(a){return m+=a.split(/\n/).length-1,k&&(a=a.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),a&&(a=s[1]+b(a)+s[2]+"\n"),a}function f(b){var c=m;if(j?b=j(b,d):g&&(b=b.replace(/\n/g,function(){return m++,"$line="+m+";"})),0===b.indexOf("=")){var e=l&&!/^=[=#]/.test(b);if(b=b.replace(/^=[=#]?|[\s;]*$/g,""),e){var f=b.replace(/\s*\([^\)]+\)/,"");n[f]||/^(include|print)$/.test(f)||(b="$escape("+b+")")}else b="$string("+b+")";b=s[1]+b+s[2]}return g&&(b="$line="+c+";"+b),r(a(b),function(a){if(a&&!p[a]){var b;b="print"===a?u:"include"===a?v:n[a]?"$utils."+a:o[a]?"$helpers."+a:"$data."+a,w+=a+"="+b+",",p[a]=!0}}),b+"\n"}var g=d.debug,h=d.openTag,i=d.closeTag,j=d.parser,k=d.compress,l=d.escape,m=1,p={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},q="".trim,s=q?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],t=q?"$out+=text;return $out;":"$out.push(text);",u="function(){var text=''.concat.apply('',arguments);"+t+"}",v="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+t+"}",w="'use strict';var $utils=this,$helpers=$utils.$helpers,"+(g?"$line=0,":""),x=s[0],y="return new String("+s[3]+");";r(c.split(h),function(a){a=a.split(i);var b=a[0],c=a[1];1===a.length?x+=e(b):(x+=f(b),c&&(x+=e(c)))});var z=w+x+y;g&&(z="try{"+z+"}catch(e){throw {filename:$filename,name:'Render Error',message:e.message,line:$line,source:"+b(c)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')};}");try{var A=new Function("$data","$filename",z);return A.prototype=n,A}catch(B){throw B.temp="function anonymous($data,$filename) {"+z+"}",B}}var d=function(a,b){return"string"==typeof b?q(b,{filename:a}):g(a,b)};d.version="3.0.0",d.config=function(a,b){e[a]=b};var e=d.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},f=d.cache={};d.render=function(a,b){return q(a,b)};var g=d.renderFile=function(a,b){var c=d.get(a)||p({filename:a,name:"Render Error",message:"Template not found"});return b?c(b):c};d.get=function(a){var b;if(f[a])b=f[a];else if("object"==typeof document){var c=document.getElementById(a);if(c){var d=(c.value||c.innerHTML).replace(/^\s*|\s*$/g,"");b=q(d,{filename:a})}}return b};var h=function(a,b){return"string"!=typeof a&&(b=typeof a,"number"===b?a+="":a="function"===b?h(a.call(a)):""),a},i={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},j=function(a){return i[a]},k=function(a){return h(a).replace(/&(?![\w#]+;)|[<>"']/g,j)},l=Array.isArray||function(a){return"[object Array]"==={}.toString.call(a)},m=function(a,b){var c,d;if(l(a))for(c=0,d=a.length;d>c;c++)b.call(a,a[c],c,a);else for(c in a)b.call(a,a[c],c)},n=d.utils={$helpers:{},$include:g,$string:h,$escape:k,$each:m};d.helper=function(a,b){o[a]=b};var o=d.helpers=n.$helpers;d.onerror=function(a){var b="Template Error\n\n";for(var c in a)b+="<"+c+">\n"+a[c]+"\n\n";"object"==typeof console&&console.error(b)};var p=function(a){return d.onerror(a),function(){return"{Template Error}"}},q=d.compile=function(a,b){function d(c){try{return new i(c,h)+""}catch(d){return b.debug?p(d)():(b.debug=!0,q(a,b)(c))}}b=b||{};for(var g in e)void 0===b[g]&&(b[g]=e[g]);var h=b.filename;try{var i=c(a,b)}catch(j){return j.filename=h||"anonymous",j.name="Syntax Error",p(j)}return d.prototype=i.prototype,d.toString=function(){return i.toString()},h&&b.cache&&(f[h]=d),d},r=n.$each,s="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",t=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,u=/[^\w$]+/g,v=new RegExp(["\\b"+s.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),w=/^\d[^,]*|,\d[^,]*/g,x=/^,+|,+$/g,y=/^$|,+/;e.openTag="{{",e.closeTag="}}";var z=function(a,b){var c=b.split(":"),d=c.shift(),e=c.join(":")||"";return e&&(e=", "+e),"$helpers."+d+"("+a+e+")"};e.parser=function(a){a=a.replace(/^\s/,"");var b=a.split(" "),c=b.shift(),e=b.join(" ");switch(c){case"if":a="if("+e+"){";break;case"else":b="if"===b.shift()?" if("+b.join(" ")+")":"",a="}else"+b+"{";break;case"/if":a="}";break;case"each":var f=b[0]||"$data",g=b[1]||"as",h=b[2]||"$value",i=b[3]||"$index",j=h+","+i;"as"!==g&&(f="[]"),a="$each("+f+",function("+j+"){";break;case"/each":a="});";break;case"echo":a="print("+e+");";break;case"print":case"include":a=c+"("+b.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(e)){var k=!0;0===a.indexOf("#")&&(a=a.substr(1),k=!1);for(var l=0,m=a.split("|"),n=m.length,o=m[l++];n>l;l++)o=z(o,m[l]);a=(k?"=":"=#")+o}else a=d.helpers[c]?"=#"+c+"("+b.join(",")+");":"="+a}return a},"function"==typeof define?define("artTemplate",[],function(){return d}):"undefined"!=typeof exports?module.exports=d:this.template=d}(),define("text!im/li.tpl",[],function(){return'{{each list}}\n	{{if $value.NULL == 1}}\n		<p class="im-kong">订阅策略当天没有交易动态</p>\n	{{else}}\n		<li>\n			<div class="li-border">\n				<a target="_blank" class="im-ju-avatar-link" href="{{$value.url}}">\n					<img class="im-ju-avatar" src="{{$value.avatar}}" alt="{{$value.nickname}}">\n				</a>\n				<p class="im-ju-title">\n					<a target="_blank" class="im-ju-username" href="{{$value.url}}">{{$value.nickname}}</a>\n					<span class="im-ju-code">{{$value.zqdm}}</span>\n					<span class="im-ju-name">{{$value.zqmc}}</span>\n				</p>\n				<p class="im-ju-lastopera">\n					<span class="im-ju-price">{{$value.wtjgbefore}}</span><span class="im-ju-price-dot">.{{$value.wtjgafter}}</span>\n					{{if $value.type == \'B\'}}<span class="im-ju-opera im-ju-red">委托买入</span>{{else}}<span class="im-ju-opera im-ju-blue">委托卖出</span>{{/if}}\n					<strong>{{$value.wtsl}}</strong>股\n					{{if $value.valid == -1}}<span class="im-ju-state {{if $value.type == \'S\'}}im-ju-state-sold im-ju-state-cancel-sold{{else}}im-ju-state-buy im-ju-state-cancel-buy{{/if}}">撤单</span>\n					{{else if $value.valid == 2}}<span class="im-ju-state {{if $value.type == \'S\'}}im-ju-state-sold im-ju-state-sold{{else}}im-ju-state-buy im-ju-state-buy{{/if}}">成交</span>{{else}}{{/if}}\n				</p>\n				<p class="im-ju-time im-ju-time-state1">{{$value.time}}</p>\n				<div class="im-ju-list-wrap" style="display:none;">\n				 \n				</div>\n				{{if $value.msgnum != 1}}\n				<p class="im-ju-show png" data-action="tacticid={{$value.tacticid}}&code={{$value.zqdm}}">展开</p>\n				{{/if}}\n			</div>\n		</li>\n	{{/if}}\n{{/each}}'}),define("text!im/lidetail.tpl",[],function(){return'{{each list}}\n	<p>\n		<span class="im-ju-time im-ju-time-state2">{{$value.time}}</span><span class="im-ju-list-price">{{$value.price}}</span>{{if $value.type == \'WS\'}}<span class="bluetext">委托卖出</span>{{else if $value.type == \'CS\'}}<span class="bluetext">卖出</span>{{else if $value.type == \'WC\'}}<span class="bluetext">撤单</span>{{else if $value.type == \'CF\'}}<span class="bluetext">送股</span>{{else if $value.type == \'CP\'}}<span class="bluetext">派息</span>{{else if $value.type == \'WB\'}}<span class="redtext">委托买入</span>{{else if $value.type == \'CB\'}}<span class="redtext">买入</span>{{/if}}\n		<span class="im-ju-list-num">{{$value.detail}}股</span>\n	</p> \n{{/each}}'}),define("text!im/html.tpl",[],function(){return'<div class="im-wrap" id="im-wrap" im-state="im-1" data-login="login">\n	<div class="im-menu">\n		<a data-statid="id=c_c_tracejboclose&fid=c_c_bar" href="javascript:void(0);" style="display:none;" class="im-icon-close im-block-icon"></a>\n		<ul>\n			<li class="im-block-wrap im-avatar-wrap">\n				<div class="im-block im-block-tab" data-statid="id=c_c_bar_wo&fid=c_c_bar" tabname="info">\n					<img class="im-block-avatar png" src="//i.thsi.cn/sns/circle/newcircle/avatardefault.jpg" alt="">\n					<p class="im-block-title">未登录</p>\n				</div>\n			</li>\n			<li class="im-block-wrap" >\n				<div class="im-block im-block-tab" data-statid="id=c_c_bar_jb&fid=c_c_bar" tabname="ju">\n					<p class="png im-block-icon im-block-smallicon im-block-icon-ju"></p>\n					<p class="im-block-title">策略动态</p>\n					<i class="png im-block-icon im-icon-circle im-icon-redcircle" style="display:none;"></i>\n				</div>\n			</li>\n			<li class="im-block-wrap">\n				<div class="im-block im-block-tab" data-statid="id=c_c_bar_pl&fid=c_c_bar" tabname="msg">\n					<p class="png im-block-icon im-block-smallicon im-block-icon-translation"></p>\n					<p class="im-block-title">收到的评论</p>\n					<i class="png im-block-icon im-icon-circle im-icon-redcircle" style="display:none;"></i>\n				</div>\n			</li>\n			<li class="im-block-wrap">\n				<div class="im-block im-block-tab" data-statid="id=c_c_bar_tz&fid=c_c_bar" tabname="sysmsg">\n					<p class="png im-block-icon im-block-smallicon im-block-icon-sysmsg"></p>\n					<p class="im-block-title">系统通知</p>\n					<i class="png im-block-icon im-icon-circle im-icon-redcircle" style="display:none;"></i>\n				</div>\n			</li>\n			<li class="im-block-wrap im-history">\n				<div class="im-block">\n					<p class="png im-block-icon im-block-smallicon im-block-icon-history"></p>\n					<p class="im-block-title">最近浏览</p>\n				</div>\n			</li>\n		</ul>\n		<ol class="im-history-ol">\n			<!-- <li>\n				<a href="" class="im-history-link">同花顺</a>\n			</li>-->\n		</ol>\n	</div>\n	<div class="im-body scrollbarWrap por" id="im-scrollbar">\n		<div class="scrollbar"><div class="track"><div class="thumb"><div class="end"></div><div class="thumby"></div></div></div></div>\n		<div class="viewport">\n			<div class="overview">\n				<div class="im-body-list im-body-list-info" >\n					<!-- <div class="im-info-content">\n						<div class="im-info p020">\n							<a class="avatar" href="">\n								<img class="im-info-avatar" src="//u.thsi.cn/avatar/default/19.jpg" alt="">\n							</a>\n							<a href="" class="c444 fs18 ffyh im-info-nickname">超人联盟</a>\n							<p class="im-info-detail c999 tal">2004年入市，游资联盟成员，媒体特约撰稿人，曾任昆鼎私募操盘手，2013年度十大最佳播主，2013年...</p>\n						</div>\n						<div class="im-info-block"></div>\n						<div class="im-info-data">\n							<div class="im-info-data-wealth-title">\n								<a href="">财富点</a>\n							</div>\n							<div class="im-info-data-wealth ffyh redtext">\n								5,413.00\n							</div>\n							<div class="clearfix">\n								<div class="fl im-info-data-left">\n									<div>\n										<a href="">关注的人</a>\n									</div>\n									<div class="fs18 c777">\n										564\n									</div>\n								</div>\n								<div class="fl">\n									<div class="por im-fans">\n										<a href="javascript:;">我的粉丝</a><i class="im-block-icon im-icon-circle im-icon-redcircle" style="display:none;"></i>\n									</div>\n									<div class="fs18 c777">\n										56165164\n									</div>\n								</div>\n							</div>\n						</div>\n						<div class="im-info-block"></div>\n						<div class="im-info-link1">\n							<ul class="im-info-link1-ul">\n								<li>\n									<a class="im-links ffyh fs14" href="">\n										<div class="links-border">\n											<i class="im-block-icon im-block-middleicon im-block-icon-mycircle"></i>我的圈子\n										</div>\n									</a>\n								</li>\n								<li>\n									<a class="im-links ffyh fs14" href="">\n										<div class="links-border">\n											<i class="im-block-icon im-block-middleicon im-block-icon-joincircle"></i>加入的圈子（34）\n										</div>\n									</a>\n								</li>\n								<li>\n									<a class="im-links ffyh fs14" href="">\n										<div class="links-border">\n											<i class="im-block-icon im-block-middleicon im-block-icon-t"></i>订阅的策略\n										</div>\n									</a>\n								</li>\n							</ul>\n						</div>\n						<div class="im-info-block"></div>\n						<div class="im-info-link2">\n							<ul>\n								<li>\n									<a href="">增值服务</a>\n								</li>\n								<li>\n									<a href="">修改密码</a>\n								</li>\n								<li>\n									<a href="">账号绑定</a>\n								</li>\n							</ul>\n						</div>\n					</div> -->\n				</div>\n				<div class="im-body-list im-body-list-ju" style="display:none;">\n					<!-- <p class="im-today"><span id="im-datapick-time" class="im-today-time">2014-11-04</span><a href="javascript:void(0);" class="im-datapick" data-statid="c_c_shijianchuo"></a></p> -->\n					<!-- <div id="im-datapick-wrap"></div> -->\n					<p class="im-moremsg" style="display:none;">有新消息请查看</p>\n					<div class="im-content-title ffyh" >策略动态</div>\n					<ul class="im-ul">\n						<!-- <li>\n							<div class="li-border">\n								<a class="im-ju-avatar-link" href="">\n									<img class="im-ju-avatar" src="//u.thsi.cn/avatar/default/19.jpg" alt="">\n								</a>\n								<p class="im-ju-title">\n									<a class="im-ju-username" href="">qy1041</a>\n									<span class="im-ju-code">300189</span>\n									<span class="im-ju-name">同花顺 </span>\n								</p>\n								<p class="im-ju-lastopera">\n									<span class="im-ju-price">7</span><span class="im-ju-price-dot">.00</span><span class="im-ju-opera im-ju-red">委托卖出</span><strong>200</strong>股<span class="im-ju-state im-ju-state-sold im-ju-state-cancel">成交</span>\n								</p>\n								<p class="im-ju-time">11:23</p>\n								<div class="im-ju-list-wrap" style="display:none;">\n									<p>\n										<span class="im-ju-time im-ju-time-state3">11:12</span><span class="im-ju-list-price">12.70</span><span class="bluetext">卖出</span><span class="im-ju-list-num">300股</span>\n									</p>\n									<p>\n										<span class="im-ju-time im-ju-time-state2">11:23</span><span class="im-ju-list-price">12.60</span><span class="bluetext">委托卖出</span><span class="im-ju-list-num">123股</span>\n									</p> \n									<p>\n										<span class="im-ju-time im-ju-time-state2">11:23</span><span class="im-ju-list-price">12.60</span><span class="bluetext">委托卖出</span><span class="im-ju-list-num">123股</span>\n									</p> \n									<p>\n										<span class="im-ju-time im-ju-time-state3">11:23</span><span class="im-ju-list-price">12.60</span><span class="bluetext">委托卖出</span><span class="im-ju-list-num">123股</span>\n									</p> \n								</div>\n								<p class="im-ju-show">展开</p>\n							</div>\n						</li> -->\n					</ul>\n				</div>\n				<div class="im-body-list im-body-list-msg" style="display:none;">\n					<div class="im-content-title ffyh por">\n						<span msgtabname="strategy" class="im-title-tab dib selected" data-statid="id=c_c_bar_tz_cl&fid=c_c_bar">策略评论<i class="im-icon-circle  im-icon-redcircle im-block-icon" style="display:none;"></i>	</span>\n						<span msgtabname="chat" class="im-title-tab dib selected" data-statid="id=c_c_bar_tz_lt&fid=c_c_bar">聊天消息<i class="im-icon-circle  im-icon-redcircle im-block-icon" style="display:none;"></i>	</span>\n						<span msgtabname="post" class="im-title-tab dib" data-statid="id=c_c_bar_tz_tz&fid=c_c_bar">帖子消息<i class="im-icon-circle  im-icon-redcircle im-block-icon" style="display:none;"></i>	</span>\n						<div class="redline"></div>\n					</div>\n					<div class="im-msg im-strategy" style="display:none;">\n						<p class="im-moremsg" style="display:none;">有新消息请查看</p>\n						<ul class="im-strategy-ul">\n							<!-- jiaxiaochen添加<li class="">\n							    <div class="li-border">\n							        <div class="clearfix im-msg-title">\n							            <div class="im-msg-nickname fl">\n							                <a class="c444" href="javascripg:void(0);">哈哈哈：</a>\n							            </div>      \n							            <i class="im-icon-circle  im-icon-bluecircle im-block-icon"></i>    \n							        </div>\n							        <div class="wdwrap im-msg-content">\n							            <span class="c777">哈哈哈哈哈...</span>\n							            <a target="_blank" href="" class="im-msg-huifu bluelink">回复</a>\n							        </div>\n							                <p class="im-msg-answer c777">\n							                    评论了策略：“评论”\n							                </p>\n							                <span class="c777">该评论已被删除</span>\n							        <p class="im-msg-date c999">(日期显示)2016-09-22</p>\n							    </div>\n							</li> -->\n						</ul>\n						<a target="_blank" href="/newcircle/user/strategyComment/" class=" c444 im-msg-more">更多消息</a>\n					</div>\n					<div class="im-msg im-chat">\n						<p class="im-moremsg" style="display:none;">有新消息请查看</p>\n						<ul class="im-chat-ul">\n							<!-- <li  class="unread">\n								<div class="li-border">\n									<div class="clearfix im-msg-title">\n										<div class="im-msg-from fr">\n											<a class="redbgc" href="">同花顺</a>\n										</div>\n										<div class="im-msg-nickname fl">\n											<a class="c444" href="">大法官地方：</a>\n										</div>		\n										<i class="im-icon-circle  im-icon-bluecircle im-block-icon"></i>	\n									</div>\n									<p class="im-msg-content">\n										<span class="c777">太多次机会了，都被我浪费了，我都想揍我自己，想...</span>\n										<span class="im-msg-date c999">(04-15 09:47)</span>\n										<a href="" class="im-msg-huifu bluelink">回复</a>\n									</p>\n									<p class="im-msg-answer c777">\n										回复我的聊天：“我也是，一涨就卖！”\n									</p>\n								</div>\n							</li> -->\n						</ul>\n						<a target="_blank" href="/newcircle/user/chatComment/" class=" c444 im-msg-more">更多消息</a>\n					</div>\n					<div class="im-msg im-post" style="display:none;">\n						<p class="im-moremsg" style="display:none;">有新消息请查看</p>\n						<ul class="im-post-ul">\n							<!-- <li class="unread">\n								<div class="li-border">\n									<div class="clearfix im-msg-title">\n										<div class="im-msg-from fr">\n											<a class="redbgc" href="">同花顺</a>\n										</div>\n										<div class="im-msg-nickname fl">\n											<a class="c444" href="">帖子消息：</a>\n										</div>\n										<i class="im-block-icon"></i>\n									</div>\n									<p class="im-msg-content">\n										<span class="c777">太多次机会了，都被我浪费了，我都想揍我自己，想...</span>\n										<span class="im-msg-date c999">(04-15 09:47)</span>\n										<a href="" class="im-msg-huifu bluelink">回复</a>\n									</p>\n									<p class="im-msg-answer c777">\n										回复我的聊天：“我也是，一涨就卖！”\n									</p>\n								</div>\n							</li> -->\n						</ul>\n						<a target="_blank" href="/newcircle/user/postComment/" class=" c444 im-msg-more">更多消息</a>\n					</div>\n				</div>\n				<div class="im-body-list im-body-list-sysmsg"  style="display:none;" >\n					<div class="im-content-title ffyh por">\n						<div class="im-content-title ffyh" >系统通知</div>\n					</div>\n					<div class="im-msg im-sysmsg">\n						<ul class="im-sysmsg-ul">\n							<!-- <li  class="unread">\n								<div class="li-border">\n									<div class="clearfix im-msg-title">\n										<div class="im-msg-from fr">\n											<span class="im-msg-date c999">04-15 09:47</span>\n										</div>\n										<div class="im-msg-nickname fl">\n											<a class="c444" href="">系统消息</a>\n										</div>		\n										<i class="im-icon-circle  im-icon-bluecircle im-block-icon"></i>	\n									</div>\n									<p class="im-msg-content">\n										<span class="c777">恭喜你！你已经通过高手申请审核，可以开始你的高手之旅，在高手擂台和其他高手一决高下。</span>\n									</p>\n								</div>\n							</li> -->\n						</ul>\n						<a target="_blank" href="/newcircle/user/message" class=" c444 im-msg-more">更多消息</a>\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n<div id="J_Login" class="hide" data-login=\'login\'></div>'
}),function(){function a(){try{return h in f&&f[h]}catch(a){return!1}}function b(a){return function(){var b=Array.prototype.slice.call(arguments,0);b.unshift(d),j.appendChild(d),d.addBehavior("#default#userData"),d.load(h);var c=a.apply(e,b);return j.removeChild(d),c}}function c(a){return a.replace(m,"___")}var d,e={},f=window,g=f.document,h="localStorage",i="__storejs__";if(e.disabled=!1,e.set=function(){},e.get=function(){},e.remove=function(){},e.clear=function(){},e.transact=function(a,b,c){var d=e.get(a);null==c&&(c=b,b=null),"undefined"==typeof d&&(d=b||{}),c(d),e.set(a,d)},e.getAll=function(){},e.serialize=function(a){return JSON.stringify(a)},e.deserialize=function(a){if("string"!=typeof a)return void 0;try{return JSON.parse(a)}catch(b){return a||void 0}},a())d=f[h],e.set=function(a,b){return void 0===b?e.remove(a):(d.setItem(a,e.serialize(b)),b)},e.get=function(a){return e.deserialize(d.getItem(a))},e.remove=function(a){d.removeItem(a)},e.clear=function(){d.clear()},e.getAll=function(){for(var a={},b=0;b<d.length;++b){var c=d.key(b);a[c]=e.get(c)}return a};else if(g.documentElement.addBehavior){var j,k;try{k=new ActiveXObject("htmlfile"),k.open(),k.write('<script>document.w=window</script><iframe src="/favicon.ico"></frame>'),k.close(),j=k.w.frames[0].document,d=j.createElement("div")}catch(l){d=g.createElement("div"),j=g.body}var m=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");e.set=b(function(a,b,d){return b=c(b),void 0===d?e.remove(b):(a.setAttribute(b,e.serialize(d)),a.save(h),d)}),e.get=b(function(a,b){return b=c(b),e.deserialize(a.getAttribute(b))}),e.remove=b(function(a,b){b=c(b),a.removeAttribute(b),a.save(h)}),e.clear=b(function(a){var b=a.XMLDocument.documentElement.attributes;a.load(h);for(var c,d=0;c=b[d];d++)a.removeAttribute(c.name);a.save(h)}),e.getAll=b(function(a){for(var b,d=a.XMLDocument.documentElement.attributes,f={},g=0;b=d[g];++g){var h=c(b.name);f[b.name]=e.deserialize(a.getAttribute(h))}return f})}try{e.set(i,i),e.get(i)!=i&&(e.disabled=!0),e.remove(i)}catch(l){e.disabled=!0}e.enabled=!e.disabled,"undefined"!=typeof module&&"function"!=typeof module?module.exports=e:"function"==typeof define&&define.amd?define("store",e):this.store=e}(),define("rewardMsg",[],function(){function a(a){this.rewardMsgEvent(a)}return a.prototype.rewardMsgEvent=function(a){var b={num:a};$.ajax({url:"/newcircle/reward/getRewardData/",type:"GET",data:b,dataType:"json",success:function(a){if(0===a.errorCode){var b=a.rewardData,c='<div class="reward-env-con"><a href="javascript:void(0);" class="rew-env-close" title="关闭"></a><div class="rew-let"></div><div class="rew-env-i"></div><div class="cfff tac rew-env-o"><p class="rew-from"></p><p class="rew-value"></p></div></div>',d=0,e=null,f=function(a){return a>=b.length?!1:($("body").append(c),$(".reward-env-con .rew-from").html(b[a].name),$(".reward-env-con .rew-value").html("向您支持"+b[a].money+"元"),$(".reward-env-con").animate({bottom:"60px"},300,function(){var b=$(this);b.find(".rew-let").stop().animate({top:"-30px"},500).animate({top:"0"},500),e=window.setTimeout(function(){b.stop().animate({bottom:"-160px"},300,function(){b.remove(),a++,f(a)})},3e3)}),void $(".reward-env-con .rew-env-close").click(function(){$(this).parents(".reward-env-con").stop().animate({bottom:"-160px"},300,function(){$(this).remove(),window.clearTimeout(e),a++,f(a)})}))};f(d)}}})},a}),define("../../../js/require-modules/editor/FaceData.js",[],function(){var a=[[{value:"[呲牙]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f0.png"},{value:"[发呆]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f1.png"},{value:"[抠鼻]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f2.png"},{value:"[困了]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f3.png"},{value:"[撇嘴]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f4.png"},{value:"[冷汗]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f5.png"},{value:"[亲亲]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f6.png"},{value:"[浪笑]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f7.png"},{value:"[闭嘴]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f8.png"},{value:"[委屈]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f9.png"},{value:"[点头]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f10.png"},{value:"[花痴]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f11.png"},{value:"[再见]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f12.png"},{value:"[发怒]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f13.png"},{value:"[大骂]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f14.png"},{value:"[晕]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f15.png"},{value:"[鄙视]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f16.png"},{value:"[糗大了]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f17.png"},{value:"[鼓掌]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f18.png"},{value:"[抓狂]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f19.png"},{value:"[叹一口气]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f20.png"},{value:"[奋斗]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f21.png"},{value:"[猪头]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f22.png"},{value:"[上香]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f23.png"},{value:"[鲜花]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f24.png"},{value:"[蜡烛]",src:"//i.thsi.cn/sns/circle/wapcircle/img2/smallface/f25.png"}],[{value:"[奔跑]",src:"//i.thsi.cn/images/ucenter/face/default/f0.gif"},{value:"[吃惊]",src:"//i.thsi.cn/images/ucenter/face/default/f1.gif"},{value:"[大汗]",src:"//i.thsi.cn/images/ucenter/face/default/f2.gif"},{value:"[大哭]",src:"//i.thsi.cn/images/ucenter/face/default/f3.gif"},{value:"[大笑]",src:"//i.thsi.cn/images/ucenter/face/default/f4.gif"},{value:"[顶]",src:"//i.thsi.cn/images/ucenter/face/default/f5.gif"},{value:"[飞吻(右)]",src:"//i.thsi.cn/images/ucenter/face/default/f6.gif"},{value:"[飞吻(左)]",src:"//i.thsi.cn/images/ucenter/face/default/f7.gif"},{value:"[尴尬]",src:"//i.thsi.cn/images/ucenter/face/default/f8.gif"},{value:"[害羞]",src:"//i.thsi.cn/images/ucenter/face/default/f9.gif"},{value:"[嘿嘿]",src:"//i.thsi.cn/images/ucenter/face/default/f10.gif"},{value:"[口水]",src:"//i.thsi.cn/images/ucenter/face/default/f11.gif"},{value:"[雷]",src:"//i.thsi.cn/images/ucenter/face/default/f12.gif"},{value:"[耍帅]",src:"//i.thsi.cn/images/ucenter/face/default/f13.gif"},{value:"[吐]",src:"//i.thsi.cn/images/ucenter/face/default/f14.gif"},{value:"[凄凉]",src:"//i.thsi.cn/images/ucenter/face/default/f15.gif"},{value:"[微笑]",src:"//i.thsi.cn/images/ucenter/face/default/f16.gif"},{value:"[可怜]",src:"//i.thsi.cn/images/ucenter/face/default/f17.gif"},{value:"[喜欢]",src:"//i.thsi.cn/images/ucenter/face/default/f18.gif"},{value:"[疑问]",src:"//i.thsi.cn/images/ucenter/face/default/f19.gif"},{value:"[转]",src:"//i.thsi.cn/images/ucenter/face/default/f20.gif"},{value:"[跌停]",src:"//i.thsi.cn/images/ucenter/face/default/f21.gif"},{value:"[涨停]",src:"//i.thsi.cn/images/ucenter/face/default/f22.gif"},{value:"[强]",src:"//i.thsi.cn/images/ucenter/face/default/f37.gif"},{value:"[弱]",src:"//i.thsi.cn/images/ucenter/face/default/f38.gif"},{value:"[下钱雨]",src:"//i.thsi.cn/images/ucenter/face/default/f25.gif"},{value:"[傻笑]",src:"//i.thsi.cn/images/ucenter/face/default/f26.gif"},{value:"[火炬]",src:"//i.thsi.cn/images/ucenter/face/default/f27.gif"},{value:"[给力]",src:"//i.thsi.cn/images/ucenter/face/default/f28.gif"},{value:"[恭喜发财]",src:"//i.thsi.cn/images/ucenter/face/default/f29.gif"},{value:"[OK]",src:"//i.thsi.cn/images/ucenter/face/default/f30.gif"},{value:"[握手]",src:"//i.thsi.cn/images/ucenter/face/default/f31.gif"},{value:"[咖啡]",src:"//i.thsi.cn/images/ucenter/face/default/f32.gif"},{value:"[心]",src:"//i.thsi.cn/images/ucenter/face/default/f33.gif"},{value:"[礼物]",src:"//i.thsi.cn/images/ucenter/face/default/f34.gif"},{value:"[飘过]",src:"//i.thsi.cn/images/ucenter/face/default/f35.gif"},{value:"[心碎]",src:"//i.thsi.cn/images/ucenter/face/default/f36.gif"},{value:"[让红包飞]",src:"//i.thsi.cn/images/ucenter/face/default/f23.gif"},{value:"[大红灯笼]",src:"//i.thsi.cn/images/ucenter/face/default/f24.gif"},{value:"[闪电]",src:"//i.thsi.cn/images/ucenter/face/default/f39.gif"},{value:"[VIP]",src:"//i.thsi.cn/images/ucenter/face/default/f40.gif"},{value:"[圣诞老人]",src:"//i.thsi.cn/images/ucenter/face/default/f41.gif"},{value:"[太阳]",src:"//i.thsi.cn/images/ucenter/face/default/f42.gif"},{value:"[威武]",src:"//i.thsi.cn/images/ucenter/face/default/f43.gif"},{value:"[电话]",src:"//i.thsi.cn/images/ucenter/face/default/f44.gif"},{value:"[多云]",src:"//i.thsi.cn/images/ucenter/face/default/f46.gif"},{value:"[下雨]",src:"//i.thsi.cn/images/ucenter/face/default/f47.gif"},{value:"[囧]",src:"//i.thsi.cn/images/ucenter/face/default/f48.gif"},{value:"[骷髅]",src:"//i.thsi.cn/images/ucenter/face/default/f49.gif"},{value:"[打酱油]",src:"//i.thsi.cn/images/ucenter/face/default/f50.gif"},{value:"[刀]",src:"//i.thsi.cn/images/ucenter/face/default/f51.gif"},{value:"[月亮]",src:"//i.thsi.cn/images/ucenter/face/default/f52.gif"},{value:"[赞]",src:"//i.thsi.cn/images/ucenter/face/default/f53.gif"},{value:"[神马]",src:"//i.thsi.cn/images/ucenter/face/default/f54.gif"},{value:"[钟]",src:"//i.thsi.cn/images/ucenter/face/default/f55.gif"},{value:"[砖石]",src:"//i.thsi.cn/images/ucenter/face/default/f56.gif"},{value:"[粽子]",src:"//i.thsi.cn/images/ucenter/face/default/f57.gif"}]];return a}),define("../../../js/require-modules/editor/EditorFace.js",["requirePath/editor/FaceData.js"],function(a){function b(b){var c={faceClickCallback:function(){},facaDataUrl:a,trigger:"",$input:""},d=$.extend(c,b);if(!d.trigger)return!1;this.options=d;var e=$(d.trigger),f=this;e.each(function(){var a=$(this);a.click(function(){f.init(a)})})}function c(a,b){var c=a.offset().top-$(document).scrollTop(),e=d()-c,f=b.outerHeight(),g=(b.outerWidth(),!0);f>c&&e>=f?g=!0:f>e&&c>f&&(g=!1);var h=a.offset(),i=(a.outerWidth(),a.outerHeight()),j={left:h.left-15,top:h.top+i+5,position:"absolute","z-index":1e4};return g||(j.top=h.top-f-5),b.css(j).show(),g}function d(){var a=document.body&&document.body.clientHeight?document.body.clientHeight:0,b=document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:0;return Math.min(a,b)}var a=a;return b.prototype.init=function(a){this.$trigger=a,this._insertFaceTpl(),this.setEvents(),this.setPosition()},b.prototype.getFaceData=function(){var a=this.options;this.renderFace(a.facaDataUrl,0),this.$J_EditorFace.attr("isLoad","true")},b.prototype.renderFace=function(a,b){for(var c=this,d="",e=a[b].length,f=0;e>f;f++)d+=c.simpleTemplate("",a[b][f]);c.insertFaceHtml(d,b)},b.prototype.insertFaceHtml=function(a,b){this.$J_EditorFace.find(".editor-emotion-panel").eq(b).attr("isLoad","true").empty().append(a),this.setPosition()},b.prototype.loadImg=function(a,b){var c=new Image;c.src=a,c.complete?b.call(c):c.onload=function(){c.onload=null,b.call(c)}},b.prototype.setEvents=function(){var a=this.$J_EditorFace,b=this.options,c=this;a.off("click","a").on("click","a",function(){"["+$(this).attr("title")+"]";"function"==typeof b.faceClickCallback&&b.faceClickCallback(this),c.hideFaceNode()}),a.off("click",".editor-emotion-nav-item").on("click",".editor-emotion-nav-item",function(){var d=$(this),e=d.index();d.siblings(".editor-emotion-nav-item").removeClass("editor-emotion-nav-cur").end().addClass("editor-emotion-nav-cur"),1==e&&"true"!=a.find(".editor-emotion-panel").eq(e).attr("isLoad")&&c.renderFace(b.facaDataUrl,e),a.find(".editor-emotion-panel").hide().eq(e).show(),c.setPosition()}),"true"!=this.$trigger.data("isBindEvent")&&a.find(".editor-emotion-nav-item").eq(0).trigger("click"),this.$trigger.data("isBindEvent","true"),a.on("click",function(){setTimeout(function(){a.find(".editor-emotion-nav-cur").focus()},0)}),$(document).on("click",function(a){var b=$(a.target);b.parents("#J_EditorFace").length||$.contains(c.$trigger[0],b[0])||b.parents(".editor-face").length||b.hasClass("editor-face")||b.hasClass("edui-for-face")||b.parents(".edui-for-face").length||c.hideFaceNode()}),$(document).scroll(function(){a.hide()})},b.prototype.hideFaceNode=function(){this.$J_EditorFace&&this.$J_EditorFace.hide()},b.prototype.setPosition=function(){var a=this.$trigger,b=this.$J_EditorFace,d=this.$J_EditorFace.find(".editor-arrow");c(a,b)?d.hasClass("editor-arrowdown")&&d.removeClass("editor-arrowdown")&&d.addClass("editor-arrowup"):d.hasClass("editor-arrowup")&&d.removeClass("editor-arrowup")&&d.addClass("editor-arrowdown")},b.prototype._insertFaceTpl=function(){if($("#J_EditorFace").length)this.$J_EditorFace=$("#J_EditorFace");else{var a='<div id="J_EditorFace" class="editor-dialog" style="display: none;">\n    <div class="editor-dialog-wrap">\n        <i class="editor-arrow editor-arrowup"></i>\n        <!-- <i class="editor-arrow editor-arrowdown"></i> -->\n        <div class="editor-dialog-main">\n            <div class="editor-emotion-nav">\n                <a class="editor-emotion-nav-item editor-emotion-nav-cur" href="javascript:void(0);">默认表情</a>\n                <a class="editor-emotion-nav-item" href="javascript:void(0);">小熊猫表情</a>\n            </div>\n             <div class="editor-emotion">\n                <div class="editor-emotion-panel" style="display: block;">\n                    <img src="https://i.thsi.cn/sns/circle/loading.gif" alt="正在加载...">\n                </div>\n                <div class="editor-emotion-panel">\n                    <img src="http://i.thsi.cn/sns/circle/loading.gif" alt="正在加载...">\n                </div>                \n             </div>\n        </div>\n    </div>\n</div>';$("body").append(a),this.$J_EditorFace=$("#J_EditorFace")}"true"!=this.$J_EditorFace.attr("isLoad")&&this.getFaceData();var b=this.$J_EditorFace;setTimeout(function(){b.find(".editor-emotion-nav-cur").focus()},0)},b.prototype.simpleTemplate=function(a,b){var c='<a title="$value$" href="javascript:;"><img title="$value$" src="$src$" class="snsface"></a>';return a=a||c,a.replace(/\$\w+\$/gi,function(a){var c=b[a.replace(/\$/g,"")];return c+""=="undefined"?"":c})},b}),function(a){a.fn.AjaxFileUpload=function(b){function c(c){var h=a(c.target),j=h.attr("id"),k=h.removeAttr("id").clone().attr("id",j).AjaxFileUpload(b),l=h.val().replace(/.*(\/|\\)/,""),m=f(),n=g(m);k.insertBefore(h),i.onChange.call(k[0],l),m.bind("load",{element:k,form:n,filename:l},e),n.append(h).bind("submit",{element:k,iframe:m,filename:l},d).submit()}function d(b){var c=i.onSubmit.call(b.data.element,b.data.filename);if(c===!1)return a(b.target).remove(),b.data.iframe.remove(),!1;for(var d in c)a("<input />").attr("type","hidden").attr("name",d).val(c[d]).appendTo(b.target)}function e(b){try{var c=a(b.target),d=(c[0].contentWindow||c[0].contentDocument).document,e=d.body.innerHTML;e.indexOf("413 Request Entity Too Large")>-1?e={msg:"上传图片过大，请重新选择"}:e?(e=e.replace(/<.*<\/.*>/g,""),e=a.parseJSON(e)):e={}}catch(b){e={msg:"文件上传失败"}}i.onComplete.call(b.data.element,b.data.filename,e),b.data.form.remove(),c.remove()}function f(){var b=j();return a("body").append('<iframe src="javascript:false;" name="'+b+'" id="'+b+'" style="display: none;"></iframe>'),a("#"+b)}function g(b){return a("<form />").attr({method:"post",action:i.action,enctype:"multipart/form-data",target:b[0].name}).hide().appendTo("body")}var h={action:"upload.php",onChange:function(){},onSubmit:function(){},onComplete:function(){}},i=a.extend({},h,b),j=function(){var a=0;return function(){return"_AjaxFileUpload"+a++}}();return this.each(function(){var b=a(this);b.is("input")&&"file"===b.attr("type")&&b.bind("change",c)})}}(jQuery),"undefined"!=typeof module&&module.exports&&this.module!==module?define("ajaxFileUpload"):"function"==typeof define&&define.amd&&define("ajaxFileUpload"),define("../../../js/require-modules/editor/ajaxfileupload.js",function(){}),define("../../../js/require-modules/editor/imgDialog.js",[],function(){function a(a){var b={tpl:""};if(this.options=$.extend(b,a),this.options.tpl&&this.options.$base.length){if($("#J_ImgDialog").length)c=$("#J_ImgDialog");else var c=$(this.options.tpl).appendTo($("body")).hide();this.$element=c,this.$closeBtn=c.find('[node-type="imgdelete"]'),this.setEvents()}}return a.prototype={setEvents:function(){var a=this.$element,b=this;a.on("click",'[node-type="imgdelete"]',function(){b.hide()})},hide:function(){var a=this.$element;a.hide().find('[node-type="imgvalue"]').val("");var b=this.options,a=this.$element;SNS.isFunction(b.hideCallback)&&b.hideCallback.call(this,a)},doShowCallback:function(){var a=this.options,b=this.$element;SNS.isFunction(a.showCallback)&&a.showCallback.call(this,b)},showLoading:function(){var a=this.$element;this.setPosition(),a.hide().find('[node-type="imgvalue"]').val(""),a.find(".editor-uploadimg-loading").show(),a.find(".editor-uploadimg-show").hide()},show:function(a,b){var c=this.$element;c.find(".editor-uploadimg-loading").hide(),c.find(".editor-uploadimg-show").show().find("img").css({"background-image":"url("+a+")"}),c.find('[node-type="imgvalue"]').val(a),SNS.isFunction(b)&&b.call(this,c),this.setPosition()},showAn:function(){var a=this.$element;a.fadeIn(500)},hideAn:function(){var a=this.$element;a.fadeOut(500)},getImgUrl:function(){return this.$element.find('[node-type="imgvalue"]').val()},setPosition:function(){var a=this.$element,b=this.options.$base;a.css({top:b.offset().top-a.outerHeight(),left:b.offset().left-15}).show(),this.doShowCallback()}},a}),define("EditorSmall",["requirePath/editor/EditorFace.js","requirePath/editor/ajaxfileupload.js","requirePath/editor/imgDialog.js"],function(a,b,c){function d(a){a.bind("mouseup keyup",function(b){var c=a.val(),d=l(a[0]);"undefined"!=typeof d.start&&a.attr("range",d.start+"&"+d.end),(b.keyCode>40||37==b.keyCode||39==b.keyCode||8==b.keyCode||32==b.keyCode)&&(c=a.val(),d=l(a[0]),"undefined"!=typeof d.start&&a.attr("range",d.start+"&"+d.end))})}function e(a){var b={placeholderText:"",showCheckbox:!1,checkboxText:"同时转载",$container:"",upload:!1,url:!1,topic:!0,fastreturn:!1,quote:!1,quoteClass:"",btntopic:!1,ticket:!1,wordlimit:-1},c=$.extend(b,a);return c.$container?(this.options=c,this.$container=c.$container,void this.init()):!1}var f=[];f.push('<div id="J_newImgDialog" class="editor-dialog" style="width:300px;">','<div class="editor-dialog-wrap">','<i class="editor-arrow editor-arrowdown"></i>','<div class="editor-dialog-main">','<div class="editor-emotion-nav" style="width:auto;">','<span class="editor-emotion-nav-item editor-emotion-nav-cur">本地上传</span>','<a class="editor-delete" node-type="imgdelete" href="javascript:void(0);">删除</a>',"</div>",'<div class="editor-emotion" style="width:auto;">','<div class="editor-uploadimg-loading">','<div class="editor-uploadimg-loading-text">图片正在上传，请等候...</div>',"</div>",'<div class="editor-uploadimg-show">','<img src="//i.thsi.cn/images/ucenter/transparent.gif" alt="" > ',"</div>","</div>","</div>","</div>",'<input node-type="imgvalue" type="hidden">',"</div>");var g=[];g.push('<div class="editor-dialog J_url" style="display:none;">','<div class="editor-dialog-wrap">','<i class="editor-arrow editor-arrowdown"></i>','<div class="editor-dialog-main">','<input class="url-input input24" type="text"><a href="javascript:;" class="url-sure btn p010 bluebg ml10">确定</a>','<div class="fz12 c999 lh2 url-hint">例：http://www.10jqka.com.cn/</div>',"</div>","</div>",'<input node-type="imgvalue" type="hidden">',"</div>");var h=[];h.push('<div class="editor-dialog J_ticket" style="display:none;">','<div class="editor-dialog-wrap">','<div class="triangle triangle-out">','<div class="triangle triangle-in"></div>',"</div>",'<div class="editor-dialog-main">','<div class="editor-ticket-nav">','<span class="editor-ticket-discount" style="display:none;">折扣券</span>','<span class="editor-ticket-experience">体验券</span>',"</div>",'<div class="experience-ticket-container">','<div class="experience-ticket-date c444 fz12 ml5 por">',"<span>体验期限：</span>",'<input type="text" class="exp-ticket-date tac" placeholder="3-5"/>',"<span>个交易日</span>","</div>",'<div class="experience-ticket-num c444 fz12 ml5 por">',"<span>体验券数量：</span>",'<input type="text" class="exp-ticket-num tac" placeholder="1-99"/>',"<span>张</span>","</div>",'<div class="experience-ticket-msg c444 fz12 ml5 por">','<textarea class="exp-ticket-msg" placeholder="恭喜发财，天天涨停" maxlength="20"></textarea>',"</div>","</div>",'<div class="experience-ticket-action clearfix">','<span class="fl c999">PS：每日只能发放一次</span>','<span class="fr bluetext ticket-submit" data-statid="c_c_hongbao.send">发放</span>','<span class="fr c999"><span class="ticket-word">0</span>/20</span>',"</div>",'<div class="discount-ticket-wrap ticket-container" style="display:none;"></div>',"</div>","</div>","</div>");var i=[];i.push('<div id="J_fastImgDialog" class="editor-dialog" style="width:300px;">','<div class="editor-dialog-wrap">','<i class="editor-arrow editor-arrowdown"></i>','<div class="editor-dialog-main">','<div class="editor-emotion-nav" style="width:auto;">','<span class="editor-emotion-nav-item editor-emotion-nav-cur">本地上传</span>','<a class="editor-delete" node-type="imgdelete" href="javascript:void(0);">删除</a>',"</div>",'<div class="editor-emotion" style="width:auto;">','<div class="editor-uploadimg-loading">','<div class="editor-uploadimg-loading-text">图片正在上传，请等候...</div>',"</div>",'<div class="editor-uploadimg-show">','<img src="http://i.thsi.cn/images/ucenter/transparent.gif" alt="" > ',"</div>","</div>","</div>","</div>",'<input node-type="imgvalue" type="hidden">',"</div>");var j=[];j.push('<div class="fast-dialog J_url" style="display:none;">','<div class="editor-dialog-wrap">','<i class="editor-arrow editor-arrowdown"></i>','<div class="editor-dialog-main">','<input class="url-input input24" type="text"><a href="javascript:;" class="url-sure btn p010 bluebg ml10">确定</a>','<div class="fz12 c999 lh2 url-hint">例：http://www.10jqka.com.cn/</div>',"</div>","</div>",'<input node-type="imgvalue" type="hidden">',"</div>");var k=function(a,b,c,d){if("undefined"!=typeof b){var e=$(a).val(),f=e.substring(0,c)+b+e.substring(d,e.length);if(document.selection){$(a).attr("placeholder")&&$(a).val(f);var g=a.createTextRange();g.moveStart("character",c+b.length),g.collapse(!0),g.select()}else if("number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd){var h=c;$(a).val(f),h+=b.length,a.selectionStart=a.selectionEnd=h}else a.value+=b;a.focus(),$(a).val(f),$(a).attr("range",c+b.length+"&"+(c+b.length))}},l=function(a){var b,c;if("number"==typeof a.selectionStart)b=a.selectionStart,c=a.selectionEnd;else if(document.selection){var d,e=document.selection.createRange();if(e.parentElement().id==a.id){for(d=document.body.createTextRange(),d.moveToElementText(a),b=0;d.compareEndPoints("StartToStart",e)<0;b++)d.moveStart("character",1);for(var f=0;b>=f;f++)"\n"==a.value.charAt(f)&&b++;for(d=document.body.createTextRange(),d.moveToElementText(a),c=0;d.compareEndPoints("StartToEnd",e)<0;c++)d.moveStart("character",1);for(var g=0;c>=g;g++)"\n"==a.value.charAt(g)&&c++}}return{start:b,end:c}};return e.prototype.init=function(){this.createEditorsmall(),this.setEvents(),this.options.upload&&(this.upload(),this.imgDialogBindEvent()),this.addToolbarIcon(),this.options.url&&this.urlBindEvent(),this.options.topic&&this.topicBindEvent(),this.options.fastreturn&&this.fastreturnBindEvent(),this.options.ticket&&this.sendticketBindEvent(),this.options.wordlimit>-1&&(this.wordlimitInit(),this.wordlimitBindEvent()),this.options.btntopic&&(this.btntopicInit(),this.btntopicBindEvent())},e.prototype.createEditorsmall=function(){var a='<div class="editor-small editor-small-skin">\n    <div class="editor-small-txt">\n        <div class="editor-textarea-wrap">\n            <fieldset>\n                <textarea node-type="postCoentent_input" submit-btn="publishBtn" class="editor-textarea"></textarea>\n            </fieldset>\n        </div>\n    </div>\n    <div class="editor-small-action">\n        <div class="editor-small-handle">\n            <label class="editor-small-label">\n                <input class="editor-small-checkbox" type="checkbox" />\n                <span>同时转载</span>\n            </label>\n            \n            <a class="btn cfff bluebg editor-small-btn" href="javascript:;">发送</a>    \n        </div>\n        <div class="editor-toolbar">\n            <span node-type="face_btn" input-id="postContent" data-statid="c_c_biaoqing" title="添加表情" class="toolbar-item editor-face">\n                <s></s>\n            </span></div>\n    </div>\n</div>',b=this.options,c=this.$container;c.find(".editor-small").length||c.append(a),this.$btn=c.find(".editor-small-btn"),b.showCheckbox&&(this.$label=c.find(".editor-small-label").show(),this.$label.find("span").text(b.checkboxText));var d=c.find(".editor-textarea");this.$editorTextarea=d,b.placeholderText&&d.attr("placeholder",b.placeholderText)},e.prototype.setEvents=function(){var b=this,c=this.$container;if("true"!=c.data("bindEevet")){var e=this.$editorTextarea;d(e),b.editorFace=new a({trigger:c.find(".editor-face")[0],faceClickCallback:function(a){var b=$(a).attr("title"),c=e[0],d=$(c).attr("range")||"0&0",f=d.split("&"),g=parseInt(f[0]),h=parseInt(f[1]);k(c,b,g,h)}}),c.data("bindEevet","true")}},e.prototype.getContent=function(){var a=this.$container;return a.find(".editor-textarea").val()||""},e.prototype.reset=function(){var a=this.$container;a.find(".editor-textarea").val("").focus()},e.prototype.insertTextFocus=function(a){if(""!==$.trim(a)){var b=this.$editorTextarea,c=b.attr("range")||"0&0",d=c.split("&"),e=parseInt(d[0]),f=parseInt(d[1]);k(b[0],a,e,f),b.trigger("focus").trigger("mouseup")}},e.prototype.setPlaceholder=function(a){var b=this.$editorTextarea;b.attr("placeholder",a)},e.prototype.upload=function(){var a=this,b='<span class="toolbar-item editor-upload"><s><input data-statid="c_c_tupian" title="上传图片" node-type="uploadimg" name="upfile" type="file"></s></span>';a.$container.find(".editor-toolbar").append(b),a.hasUploadImg=!1;var d=a.$container.find("[node-type=uploadimg]"),e=a.$container.find(".editor-upload");e.length&&d&&(this.imgDialog=new c({$base:$(e),tpl:f.join(""),showCallback:function(){},hideCallback:function(){}}),this.applyAjaxFileUpload(d))},e.prototype.applyAjaxFileUpload=function(a){var b=this;$(a).AjaxFileUpload({action:"/fileupload/index/upload/?apiName=sns&apiCode=0&uploadType=2&waterMark=1&thumbCk=on",onChange:function(){b.imgDialog.showLoading()},onSubmit:function(){return!0},onComplete:function(a,c){if("0"==c.errorcode)b.imgDialog.show(c.result.thurl.split(" ")[1]),b.hasUploadImg=!0;else{var d=c.msg||c.result.tip;SNS.alertBox({type:"error",tipContent:d})}setTimeout(function(){b.imgDialog.hideAn()},2e3)}})},e.prototype.imgDialogBindEvent=function(){var a,b=this,c=b.$container.find(".editor-upload");c.click(function(){b.editorFace&&b.editorFace.hideFaceNode()}),c.hover(function(){a&&clearTimeout(a),b.hasUploadImg&&b.imgDialog.showAn()},function(){a=setTimeout(function(){b.imgDialog.hideAn()},2e3)}),b.imgDialog.$element.hover(function(){a&&clearTimeout(a),b.hasUploadImg&&b.imgDialog.showAn()},function(){a=setTimeout(function(){b.imgDialog.hideAn()},2e3)}),b.imgDialog.$element.find('[node-type="imgdelete"]').on("click",function(){b.hasUploadImg=!1}),$(document).on("click",function(a){"J_newImgDialog"!=$(a.target)[0].id&&b.imgDialog.hideAn()})},e.prototype.getImgUrl=function(){return this.imgDialog&&this.options.upload?this.imgDialog.getImgUrl():void 0},e.prototype.addToolbarIcon=function(){var a,b=this,c=[];this.options.url&&(a=b.$container.find(".editor-url").length,a||c.push('<span node-type="url_btn" data-statid="c_c_url" title="添加URL" class="toolbar-item editor-url">',"<s></s>","</span>")),this.options.topic&&(a=b.$container.find(".editor-topic").length,a||c.push('<span node-type="topic_btn" data-statid="c_c_htcr" title="插入话题" class="toolbar-item editor-topic">',"<s></s>","</span>")),this.options.fastreturn&&(a=b.$container.find(".editor-fastreturn").length,c.push('<span node-type="fastreturn_btn" data-statid="c_c_kjhf" title="快捷回复" class="toolbar-item editor-fastreturn">',"<s></s>","</span>")),this.options.ticket&&(a=b.$container.find(".editor-sendticket").length,a||c.push('<span node-type="sendticket_btn" data-statid="c_c_hongbao.rk" title="发送优惠券" class="toolbar-item editor-sendticket">',"<s></s>","</span>")),this.options.quote&&c.push('<span node-type="quote_btn" data-statid="" title="引用工具" class="toolbar-item editor-quote bluetext '+this.options.quoteClass+'">[引用]',"</span>"),this.options.invitation&&c.push('<span node-type="quote_btn" data-statid="sns_work.invite" title="邀请卡" class="toolbar-item  bluetext wb-invitation-btn">[邀请卡]',"</span>"),b.$container.find(".editor-toolbar").append(c.join("")),this.urlEle=$(g.join("")).appendTo("body"),this.ticketEle=$(h.join("")).appendTo("body")},e.prototype.urlBindEvent=function(){var a=this;if(this.urlEle){var b=this.urlEle;a.$container.find("[node-type=url_btn]").on("click",function(a){if("click"==a.type){if(b.attr("setPos")!==!0){var c=$(this).offset().top,d=$(this).offset().left,e=b.outerHeight();b.css({left:d-15,top:c-e}),b.attr("setPos",!0)}$(".editor-dialog").hide(),b.show()}}),b.find(".url-sure").on("click",function(c){if("click"==c.type){var d=b.find(".url-input"),e=/^(?!\")(http:\/\/|ftp:\/\/|https:\/\/)[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^\s<>\"])*(?!\")/,f=d.val(),g=/^(http:\/\/|ftp:\/\/|https:\/\/)/;if(g.test(f)||(f="http://"+f,d.val(f)),e.test(f)){var h=" "+f+" ";a.insertTextFocus(h),d.val(""),b.fadeOut(),d.css({border:"1px solid #d9d9d9"}),b.find(".url-hint").removeClass("redtext").text("例：http://www.10jqka.com.cn/")}else d.css({border:"1px solid #d75543"}),b.find(".url-hint").addClass("redtext").text("请输入正确的网址")}}),$(document).on("click",function(a){$(a.target).closest(".J_url").length||$(a.target).closest("[node-type=url_btn]").length||b.hide()})}},e.prototype.topicBindEvent=function(){var a=this;a.$container.find("[node-type=topic_btn]").on("click",function(){var b="#";b+=1==$(".topic-today").attr("hastopic")?$.trim($(".topic-today .topic-title").text()):"请输入话题（不多于20字）",b+="#",b=" "+b+" ",a.insertTextFocus(b)})},e.prototype.btntopicInit=function(){var a=this,b=['<div class="editor-btntopic-wrap hide">','<div class="btntopic-btn-box active" data-statid="c_p_qzgzt.choosetopic"><div class="topicleft fz14">#</div><input class="btntopic-btn fz14" placeholder="请输入话题"/><div class="topicright fz14">#</div></div>',"</div>"].join("");a.$container.find(".editor-small").append(b)},e.prototype.btntopicBindEvent=function(){var a=this,b=!0;a.$container.find(".btntopic-btn-box").on("click",function(){return 0!==$(".liveTopic-container").length?void a.$container.find(".liveTopic-container").show():void(b&&($(this).removeClass("active"),b=!1,$.ajax({url:"/newcircle/live/getLiveTopic/",type:"get",dataType:"json",async:!1,success:function(b){0===b.errorCode?0===$(".liveTopic-container").length&&(a.$container.find(".editor-small").append(b.result.html),a.$container.find(".liveTopic-container li").on("click",function(){var b=$.trim($(this).text());a.$container.find(".btntopic-btn").val(b),a.$container.find(".btntopic-btn").attr("title",b),a.$container.find(".liveTopic-container").hide(),a.$container.find(".btntopic-btn").focus()})):SNS.alertBox({type:"error",tipContent:b.errorMsg})},complete:function(){b=!0}})))}),$(document).on("click",function(b){$(b.target).closest(".liveTopic-container").length||$(b.target).closest(".editor-btntopic-wrap").length||(a.$container.find(".btntopic-btn-box").addClass("active"),a.$container.find(".liveTopic-container").remove())})},e.prototype.sendticketBindEvent=function(){var a=this;if(this.ticketEle){var b=this.ticketEle;a.$container.find("[node-type=sendticket_btn]").on("click",function(a){if("click"==a.type){if(b.attr("setPos")!==!0){var c=$(this).offset().top,d=$(this).offset().left,e=b.outerHeight();b.css({left:240,top:c-e-5}),b.find(".triangle-out").css({left:d-230}),b.attr("setPos",!0)
}$(".editor-dialog").hide(),b.show()}}),b.find(".exp-ticket-msg").on("input propertychange",function(){var a=$.trim($(this).val());a.length<=20?(b.find(".ticket-word").text(a.length),b.find(".ticket-word").removeClass("hintredtext")):b.find(".ticket-word").addClass("hintredtext")});var c=!0;b.find(".ticket-submit").on("click",function(){var a=$.trim(b.find(".exp-ticket-date").val()),d=$.trim(b.find(".exp-ticket-num").val()),e=$.trim(b.find(".exp-ticket-msg").val()),f=/^[1-9]\d?$/;if("3"!==a&&"4"!==a&&"5"!==a)return SNS.alertBox({type:"error",tipContent:"体验期限在3-5个交易日内哦"}),b.find(".exp-ticket-date").focus(),!1;if(!f.test(d))return SNS.alertBox({type:"error",tipContent:"体验券数量在1-99个内哦"}),b.find(".exp-ticket-num").focus(),!1;if(""===e)e="恭喜发财，天天涨停";else if(e.length>20)return SNS.alertBox({type:"error",tipContent:"体验券附加文字不能多于20字"}),b.find(".exp-ticket-msg").focus(),!1;var g={validdays:a,releasenum:d,desc:e};c&&(c=!1,$.ajax({url:"/trace/ticket/release/",type:"get",dataType:"json",data:g,success:function(a){0===a.errorCode?(SNS.alertBox({type:"success",tipContent:a.errorMsg}),b.hide()):(SNS.alertBox({type:"error",tipContent:a.errorMsg}),b.hide())},complete:function(){c=!0}}))}),$(document).on("click",function(a){$(a.target).closest(".J_ticket").length||$(a.target).closest("[node-type=sendticket_btn]").length||b.hide()})}},e.prototype.wordlimitInit=function(){var a=this;a.$container.find(".editor-small-action").append('<div class="editor-small-wordlimit"><span class="editor-small-words">0</span>/<span class="editor-small-wordstotal">150</span></div>');var b=this.options.wordlimit;a.$container.find(".editor-small-wordstotal").text(b),this.$limitwrap=a.$container.find(".editor-small-wordlimit")},e.prototype.wordlimitBindEvent=function(){var a=this;this.$editorTextarea.on("keyup",function(){a.wordlimitFn()})},e.prototype.wordlimitFn=function(){var a=this,b=this.$editorTextarea,c=$.trim(b.val()).length;a.$limitwrap.find(".editor-small-words").text(c),c>a.options.wordlimit?a.$limitwrap.find(".editor-small-words").addClass("hintredtext"):a.$limitwrap.find(".editor-small-words").removeClass("hintredtext")},e.prototype.fastreturnBindEvent=function(){var a=this;a.thisfid=$(".glo-param").attr("data-fid"),a.$fastreturnBtn=a.$container.find("[node-type=fastreturn_btn]"),a.$fastreturnBtn.on("click",function(){if($("#editor-point-input").length&&$("#editor-point-input").prop("checked")&&SNS)return void SNS.alertBox({type:"error",tipContent:"快捷回复不能推送到关注动态"});var b=a.$fastreturnBtn.attr("data-timestamp");!b||(new Date).getTime()-parseInt(b)>12e4?a.getFastreturnAjax(a.thisfid):(a.$fastwrap.show(),a.fastreturnSetposition())}),$(document).on("click",".editor-fastreturn-dom li .editor-fastreturn-title",function(){a.reset(),a.insertTextFocus($(this).find(".fastreturn-content").text());var b=$(this).parents("li").attr("data-imgurl");a.fastImgUrl=b?b:"",a.isfastcontent=1,$(".editor-fastreturn-dom").hide(),a.backToInit(),a.$btn.trigger("click")}),$(document).on("click",function(b){var c=$(b.target);c.hasClass("editor-fastreturn-dom")||c.parents(".editor-fastreturn-dom").length||c.parents(".editor-fastreturn").length||c.closest(".fast-dialog").length||c.closest("#J_ImgDialog").length||($(".editor-fastreturn-dom").hide(),a.backToInit())}),$(document).on("click",".fastreturn-delete-icon",function(){$(this).parents(".editor-fastreturn-delete").addClass("delete-active")});var b=!0;$(document).on("click",".fastreturn-delete",function(){if($(this).parents("li").remove(),b){b=!1;var c={id:$(this).parents("li").attr("data-fastid"),fid:a.thisfid};$.ajax({url:"/newcircle/workbench/deleteQuickReply/",type:"get",dataType:"json",data:c,success:function(b){0===b.errorCode?(SNS.alertBox({type:"success",tipContent:b.errorMsg}),a.getFastreturnAjax(a.thisfid)):SNS.alertBox({type:"error",tipContent:b.errorMsg})},complete:function(){b=!0}}),a.fastreturnSetposition()}}),$(document).on("click",".fastreturn-cancel",function(){$(this).parents(".editor-fastreturn-delete").removeClass("delete-active")}),$(document).on("click",".editor-fastreturn-btnwrap",function(){return!1}),$(document).on("click",".add-fastreturn-btn",function(){$(".editor-fastreturn-dom .fastreturn-small-txt").parents(".editor-fastreturn-container").html("").parents("li").find(".editor-fastreturn-update").removeClass("update-active"),$(".editor-fastreturn-dom .add-fastreturn-btn").show(),$(this).hide();var b=$(this).parents(".editor-fastreturn-edit").find(".editor-fastreturn-container");a.initFastreturnEditor(b,1),$(".editor-fastreturn-dom").addClass("graytext")}),$(document).on("click",".editor-fastreturn-update",function(){if(!$(this).hasClass("update-active")){$(this).addClass("update-active"),$(".editor-fastreturn-dom .fastreturn-small-txt").parents(".editor-fastreturn-container").html("").parents("li").find(".editor-fastreturn-update").removeClass("update-active"),$('[data-hideBtn="0"]').length&&$(".editor-fastreturn-dom .add-fastreturn-btn").show(),$(".editor-fastreturn-dom").addClass("graytext");var b=$(this).parents("li").find(".editor-fastreturn-container");a.initFastreturnEditor(b,0)}})},e.prototype.getFastreturnAjax=function(a){var b=this,c={fid:a};$.ajax({url:"/newcircle/workbench/getQuickReplyList/",type:"get",dataType:"json",async:!1,data:c,success:function(a){if(0===a.errorCode){var c=a.result,d=b.$fastreturnBtn.attr("data-fastdata");if(d&&JSON.stringify(c)===d)return b.$fastwrap.show(),b.backToInit(),void b.fastreturnSetposition();b.$fastreturnBtn.attr("data-fastdata",JSON.stringify(a.result)),b.initFastreturnDialog()}else SNS.alertBox({type:"error",tipContent:a.errorMsg})},complete:function(){b.$fastreturnBtn.attr("data-timestamp",(new Date).getTime())}})},e.prototype.initFastreturnDialog=function(){var a=this,b=$.parseJSON($.trim(a.$fastreturnBtn.attr("data-fastdata"))),c="",d=0;b&&3===b.creator.length&&(c=" hide",d=1);var e,f,g,h=['<div class="editor-fastreturn-dom ">','<div class="triangle triangle-out">','<div class="triangle triangle-in"></div>',"</div>","<ul></ul>",'<div class="editor-fastreturn-edit">','<a href="javascript:void(0);" data-statid="c_c_xjkjhf" class="bluetext add-fastreturn-btn '+c+'" data-hideBtn="'+d+'">创建快捷回复</a>','<div class="editor-fastreturn-container">',"</div>","</div>","</div>"],i=[];if(b){for(var j=0;j<b.official.length;j++)e=b.official[j].hasimg?"dib":"hide",f='<li data-imgurl="'+b.official[j].imgurl+'"><div class="editor-fastreturn-item por fastreturn-official-item"><div class="editor-fastreturn-title textwrap vat" data-statid="c_c_gfxc"><span class="vat">官方宣传：</span><span class="fastreturn-imgicon vat '+e+'"></span><span class="fastreturn-content">'+b.official[j].content+'</span></div></div><div class="editor-fastreturn-container"></div></li>',i.push(f);for(var k=0;k<b.creator.length;k++)e=b.creator[k].hasimg?"dib":"hide",g=JSON.stringify(b.creator[k]),f='<li data-fastid="'+b.creator[k].id+'" data-imgurl="'+b.creator[k].imgurl+'" data-content="'+b.creator[k].content+'"><div class="editor-fastreturn-item por"><div class="editor-fastreturn-title textwrap vat"><span class="vat">圈主宣传：</span><span class="fastreturn-imgicon vat '+e+'"></span><span class="fastreturn-content">'+b.creator[k].content+'</span></div><div class="editor-fastreturn-btnwrap clearfix"><div class="editor-fastreturn-update fl"></div><div class="editor-fastreturn-delete fl vat"><span class="fastreturn-delete-icon dib"></span><a href="javascript:void(0);" class="fastreturn-delete bluetext vat" >确认删除</a><a href="javascript:void(0);" class="fastreturn-cancel bluetext vat">取消</a></div></div></div><div class="editor-fastreturn-container"></div></li>',i.push(f);$(".editor-fastreturn-dom").length&&$(".editor-fastreturn-dom").remove()}a.$fastwrap=$(h.join("")).appendTo("body"),a.$fastwrap.find("ul").append(i.join("")),a.fastreturnSetposition()},e.prototype.initFastreturnEditor=function(a,b){var c="创建快捷回复",d="添加",e="",f="c_c_xjkjhf_tj";b||(c="修改快捷回复",d="修改",e=a.parents("li").attr("data-content"),f="");var g=this,h=['<a href="javascript:void(0);" class="fastreturn-editor-title c444 dib">'+c+"</a>",'<div class="fastreturn-small-txt">','<div class="fastreturn-textarea-wrap">',"<fieldset>",'<textarea class="fastreturn-textarea" placeholder="">'+e+"</textarea>","</fieldset>","</div>","</div>",'<div class="fastreturn-action clearfix">','<div class="fastreturn-handle fr">','<a class="btn fastreturn-submit-btn bluetext" data-statid="'+f+'" href="javascript:;">'+d+"</a>",'<a class="btn fastreturn-cancel-btn bluetext" href="javascript:;">取消</a>',"</div>",'<div class="fastreturn-toolbar fl">','<span title="添加URL" node-type="url_btn" class="fastreturn-toolbar-item fastreturn-url"><s></s></span>',"</div>","</div>"];a.append(h.join("")).show(),this.fastUrlEle=$(j.join("")).appendTo("body"),g.fastreturnSetposition(),g.fastreturnUpload(a,b),g.fastreturnUrl(a),g.fastWordlimitInit(a,e.length),a.find(".fastreturn-cancel-btn").on("click",function(){if(b&&$('[data-hideBtn="0"]').length)$(this).parents(".editor-fastreturn-edit").find(".add-fastreturn-btn").show();else{var a=$(this).parents("li").find(".editor-fastreturn-update");a.removeClass("update-active")}return $(this).parents(".editor-fastreturn-container").html("").hide(),$(".editor-fastreturn-dom").removeClass("graytext"),g.fastreturnSetposition(),!1}),a.find(".fastreturn-submit-btn").on("click",function(){var a=$(this).parents(".editor-fastreturn-container"),c=g.fastGetImgUrl(),d=a.find("textarea").val()||"",e={fid:g.thisfid,content:d,hasimg:0,imgurl:c};if(c&&(e.hasimg=1),!(e.content&&""!==$.trim(e.content)||c))return SNS.alertBox({type:"error",tipContent:"请输入内容"}),!1;if($.trim(e.content).length>150)return SNS.alertBox({type:"error",tipContent:"发布内容不能多于150个字"}),!1;var f;b?f="/newcircle/workbench/addQuickReply/":(f="/newcircle/workbench/updateQuickReply/",e.id=$(this).parents("li").attr("data-fastid"),e.type=1),$.ajax({url:f,type:"get",dataType:"json",data:e,success:function(a){0===a.errorCode?(SNS.alertBox({type:"success",tipContent:a.errorMsg}),g.getFastreturnAjax(g.thisfid)):SNS.alertBox({type:"error",tipContent:a.errorMsg})},complete:function(){g.fastreturnSetposition()}})})},e.prototype.fastreturnUrl=function(a){if(this.fastUrlEle){var b=this.fastUrlEle;a.find("[node-type=url_btn]").on("click",function(a){if("click"==a.type){if(b.attr("setPos")!==!0){var c=$(this).offset().top,d=$(this).offset().left,e=b.outerHeight();b.css({left:d-15,top:c-e}),b.attr("setPos",!0)}$(".editor-dialog").hide(),b.show()}}),b.find(".url-sure").on("click",function(c){if("click"==c.type){var d=b.find(".url-input"),e=/^(?!\")(http:\/\/|ftp:\/\/|https:\/\/)[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^\s<>\"])*(?!\")/,f=d.val(),g=/^(http:\/\/|ftp:\/\/|https:\/\/)/;if(g.test(f)||(f="http://"+f,d.val(f)),e.test(f)){var h=" "+f+" ";if(""===$.trim(h))return;var i=a.find(".fastreturn-textarea"),j=i.attr("range")||"0&0",l=j.split("&"),m=parseInt(l[0]),n=parseInt(l[1]);k(i[0],h,m,n),i.trigger("focus").trigger("mouseup"),d.val(""),b.fadeOut(),d.css({border:"1px solid #d9d9d9"}),b.find(".url-hint").removeClass("redtext").text("例：http://www.10jqka.com.cn/")}else d.css({border:"1px solid #d75543"}),b.find(".url-hint").addClass("redtext").text("请输入正确的网址")}}),$(document).on("click",function(a){$(a.target).closest(".J_url").length||$(a.target).closest("[node-type=url_btn]").length||b.hide()})}},e.prototype.fastreturnUpload=function(a,b){var d=this;$("#J_ImgDialog").length&&$("#J_ImgDialog").remove(),a.find(".fastreturn-toolbar").append('<span class="fastreturn-toolbar-item fastreturn-upload"><s><input  title="上传图片" node-type="uploadimg" name="upfile" type="file"></s></span>'),a.attr("data-uploadimg",0);var e=a.find("[node-type=uploadimg]"),f=a.find(".fastreturn-upload");if(f.length&&e){d.fastImgDialog=new c({$base:$(f),tpl:i.join(""),showCallback:function(){},hideCallback:function(){}}),!b&&a.parents("li")&&a.parents("li").attr("data-imgurl").length?(d.fastImgDialog.showLoading(),d.fastImgDialog.show(a.parents("li").attr("data-imgurl")),d.fastImgDialog.setPosition(),d.fastHasUploadImg=!0):d.fastHasUploadImg=!1,setTimeout(function(){d.fastImgDialog.hideAn()},2e3);var g;$(e).AjaxFileUpload({action:"/fileupload/index/upload/?apiName=sns&apiCode=0&uploadType=2&waterMark=1&thumbCk=on",onChange:function(){d.fastImgDialog.showLoading()},onSubmit:function(){return!0},onComplete:function(b,c){if("0"==c.errorcode)g=c.result.thurl.split(" ")[1],d.fastImgDialog.show(g),a.parents("li").attr("data-imgurl",g),d.fastHasUploadImg=!0;else{var e=c.msg||c.result.tip;SNS.alertBox({type:"error",tipContent:e})}setTimeout(function(){d.fastImgDialog.hideAn()},2e3)}})}var h,j=a.find(".fastreturn-upload");j.click(function(){d.editorFace&&d.editorFace.hideFaceNode()}),j.hover(function(){h&&clearTimeout(h),d.fastHasUploadImg&&d.fastImgDialog.showAn()},function(){h=setTimeout(function(){d.fastImgDialog.hideAn()},2e3)}),d.fastImgDialog.$element.hover(function(){h&&clearTimeout(h),d.fastHasUploadImg&&d.fastImgDialog.showAn()},function(){h=setTimeout(function(){d.fastImgDialog.hideAn()},2e3)}),d.fastImgDialog.$element.find('[node-type="imgdelete"]').on("click",function(){d.fastHasUploadImg=!1})},e.prototype.fastGetImgUrl=function(){return this.fastImgDialog?this.fastImgDialog.getImgUrl():void 0},e.prototype.fastWordlimitInit=function(a,b){var c=this;a.find(".fastreturn-action .fastreturn-toolbar").before('<div class="fastreturn-wordlimit fr"><span class="fastreturn-words">'+b+'</span>/<span class="fastreturn-wordstotal">150</span></div>'),a.find("textarea").attr("range",b+"&"+b),a.find(".fastreturn-wordstotal").text(c.options.wordlimit);var e=a.find(".fastreturn-wordlimit");a.find(".fastreturn-textarea").on("keyup",function(){var a=$.trim($(this).val()).length;e.find(".fastreturn-words").text(a),d($(this)),a>c.options.wordlimit?e.find(".fastreturn-words").addClass("hintredtext"):e.find(".fastreturn-words").removeClass("hintredtext")})},e.prototype.fastreturnSetposition=function(){$obj1=$("[node-type=fastreturn_btn]"),$obj2=$(".editor-fastreturn-dom");var a=$obj1.offset().left-$obj2.outerWidth()/2+10,b=$obj1.offset().top-$obj2.outerHeight();$obj2.css({left:a,top:b})},e.prototype.backToInit=function(){var a=$(".editor-fastreturn-dom");a.find(".delete-active").removeClass("delete-active"),a.find(".editor-fastreturn-container .fastreturn-cancel-btn").trigger("click")},e}),define("text!im/ai.tpl",[],function(){return'<div class="ai-wrap">\n	<div class="ai-wrap-type">\n		<div class="ai-con">\n			<div class="ai-top clearfix">\n				<div class="fl ai-top-avator">\n					<img src="//i.thsi.cn/sns/circle/img2/touguai/tougu-robots.20170109.png" alt="">\n				</div>\n				<div class="fl ai-top-name">18号</div>\n				<div class="fl ai-top-intro">您的专属智能投顾</div>\n				<div class="fr ai-top-close" id="aiCloseBtn" data-statid="sns_zntg.close"></div>\n			</div>\n\n			<div class="ai-chatroom scrollbarWrap" id="scrollbarWrap-touguai">\n				<div class="scrollbar">\n					<div class="track">\n						<div class="thumb"></div>\n					</div>\n				</div>\n				<div class="viewport">\n					<div class="overview pt10 pb30">\n						<ul class="chat-wrap" data-hisdata=\'1\'>\n						\n							<div class="chat-item-kong"></div>\n						</ul>\n					</div>\n				</div>\n			</div>\n\n			<div class="ai-answerbox">\n				<div class="askbox-normal clearfix ">\n					<div class="askbox-input fl">期待您的提问</div>\n					<div class="askbox-arrow fl"></div>\n					<a href="javascript:void(0);" class="btn bluebg cfff askbox-btn fl">发送</a>\n				</div>\n				<div class="askbox-active hide">\n					<div class="editor-container"></div>\n				</div>\n			</div>\n		</div>\n		<div class="ai-triangle">\n			<div class="ai-triangle-in"></div>\n		</div>\n		<div class="ai-error"></div>\n	</div>\n</div>\n\n<div class="ai-robots por">\n	<img src="//i.thsi.cn/sns/circle/img2/touguai/tougu-robots.20170109.png" alt="">\n	<div class="ai-info hide"></div>\n</div>\n<div class="ai-workbenchRobots por hide">\n	<div>\n		<img src="//i.thsi.cn/sns/circle/img2/touguai/tougu-robots.20170109.png">\n		<span>私人助理</span>\n	</div>\n</div>'}),define("text!im/workbenchai.tpl",[],function(){return'<div class="workbenchai-wrap">\n	<div class="workbenchai-wrap-type">\n		<div class="workbenchai-con">\n			<div class="workbenchai-top clearfix">\n				<div class="fl workbenchai-top-avator">\n				</div>\n				<div class="fl workbenchai-top-name">私人助理</div>\n				<div class="fr workbenchai-top-close close-up" id="aiCloseBtn">\n				</div>\n				<div class="fr workbenchai-top-intro hide"><span class="workbenchai-top-flag"></span>您有<span id="newDataNum">1</span>条新消息待查收</div>\n				<div class="workbenchai-top-bubble" style="display:none;" data-statid="sns_zntg_tob_qipao"></div>\n			</div>\n			<div class="ai-chatroom scrollbarWrap" id="scrollbarWrap-touguai">\n				<div class="scrollbar">\n					<div class="track">\n						<div class="thumb"></div>\n					</div>\n				</div>\n				<div class="viewport">\n					<div class="overview pt10 pb30">\n						<ul class="chat-wrap" data-hisdata=\'1\'>\n						\n							<div class="chat-item-kong"></div>\n						</ul>\n					</div>\n				</div>\n			</div>\n\n			<div class="ai-answerbox">\n				<div class="askbox-normal clearfix ">\n					<div class="askbox-input fl">期待您的提问</div>\n					<div class="askbox-arrow fl"></div>\n					<a href="javascript:void(0);" class="btn coolbluebg cfff askbox-btn fl">发送</a>\n				</div>\n				<div class="askbox-active hide">\n					<div class="editor-container"></div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n'}),define("zoomImg",[],function(){function a(a){return this.$container=a,this.init()}function b(a,b,c){var d=b.width()>a.width()/a.height()*b.height()?!0:!1;d?b.css("width",c*a.width()+"px").css({top:(a.height()-b.height())/2+"px",left:(a.width()-b.width())/2+"px"}):b.css("height",c*a.height()+"px").css({top:(1-c)/2*a.height()+"px",left:(a.width()-b.width())/2+"px"})}a.prototype.init=function(){this.bindEvent()},a.prototype.bindEvent=function(){var a=this;a.$container.delegate("[zoomImg]","click",function(b){var c=$(b.currentTarget);a.getSrcLink(c),a.thumbInit(a.imgLink)})},a.prototype.thumbInit=function(a){var b=this,c='<div class="wating">wating</div><div class="cav" style="display:none;width:800px;height:600px;position: relative;overflow: hidden;text-align: center;z-index: 1;"><img src="'+a+'" class="showPhoto" style="position: absolute;top:0;left:0; z-index: 2;"><div class="thumb " style="position: absolute;bottom: 0;right: 0;border: solid 1px #000; z-index: 5;background: #000;opacity: 0;filter:alpha(opacity=0);"><img src="'+a+'" style="position: absolute;top:0;left:0; z-index: 10;pointer-events:none;"><div class="thumbnail" style="width: 100%;height: 100%;position: absolute;top: 0;left: 0;border: solid 3px #fff;z-index: 100;background-image:url(about:blank);cursor: move;"></div></div><div style="width:100%;height:100%;position: absolute;top:0;left:0;overflow: hidden;text-align: center;z-index: 1;background: #000;opacity:0.6;filter:alpha(opacity=60);"></div>',d={data:{newTpl:c,width:"auto"},afershowCallback:b.load};new SNS.Dialog(d)};var c={init:function(){canWheel=!1,curScale=.94,maxScale=3,minScale=.5,spBaseWidth=0,spBaseHeight=0,$sc=$(".cav"),$sp=$(".cav .showPhoto"),$st=$(".cav .thumb"),$stn=$(".cav .thumbnail"),c.eventBind()},eventBind:function(){b($sc,$sp,curScale),spBaseWidth=$sp.width()/curScale,spBaseHeight=$sp.height()/curScale,c.mouseWheel()},resetImg:function(a,b){$sp.css({width:a+"px",height:b+"px"}).css({top:($sc.height()-$sp.height())/2+"px",left:($sc.width()-$sp.width())/2+"px"})},mouseWheel:function(){document.body.addEventListener?(document.body.addEventListener("mousewheel",c.mousewheelHandler,!1),document.body.addEventListener("DOMMouseScroll",c.mousewheelHandler,!1)):document.body.attachEvent("onmousewheel",c.mousewheelHandler)},imgMove:function(){var a=0,b=0;"width"===SPsign?(b=-1*parseInt($stn.css("left"))/$st.width()*$sp.width(),a=(parseInt($st.find("img").css("top"))-parseInt($stn.css("top")))*$sc.height()/$stn.height()):"height"===SPsign&&(a=-1*parseInt($stn.css("top"))/$st.height()*$sp.height(),b=(parseInt($st.find("img").css("left"))-parseInt($stn.css("left")))*$sc.width()/$stn.width()),$sp.css({left:b+"px",top:a+"px"})},mousewheelHandler:function(a){if(canWheel){var a=($sp.width(),$sp.height(),a||window.event||window.e),b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)),e=curScale*(1+.1*b)*spBaseWidth,f=curScale*(1+.1*b)*spBaseHeight;minScale*spBaseWidth>=e&&-1===b?(curScale=minScale,e=minScale*spBaseWidth,f=minScale*spBaseHeight):e>=maxScale*spBaseWidth&&1===b?(curScale=maxScale,e=maxScale*spBaseWidth,f=maxScale*spBaseHeight):curScale*=1+.1*b,c.resetImg(e,f),d.resetBlankSpace(),a.stopPropagation&&(a.stopPropagation(),a.cancelBubble=!0),a.preventDefault&&(a.preventDefault(),a.returnValue=!1)}}},d={init:function(){stBaseWidth=$sc.width()/3,stBaseHeight=$sc.height()/3,$st.width(stBaseWidth),$st.height(stBaseHeight),b($st,$st.find("img"),1),onstn=!1,canMove=!1,pointerLeft=0,pointerTop=0,d.eventBind(),document.body.addEventListener?(document.body.addEventListener("mousedown",d.mouseDown,!1),document.body.addEventListener("mousemove",d.mouseMove,!1),document.body.addEventListener("mouseup",d.mouseUp,!1),document.body.addEventListener("dragstart",d.stopDefault,!1),document.body.addEventListener("DOMMousedown",d.mouseDown,!1),document.body.addEventListener("DOMMousemove",d.mouseMove,!1),document.body.addEventListener("DOMMouseup",d.mouseUp,!1),document.body.addEventListener("DOMDragstart",d.stopDefault,!1)):(window.document.onmousedown=d.mouseDown,window.document.onmousemove=d.mouseMove,window.document.onmouseup=d.mouseUp,window.document.ondragstart=d.stopDefault)},eventBind:function(){d.mouseOver(),d.mouseOut()},resetBlankSpace:function(){if($sp.width()>$sc.width()||$sp.height()>$sc.height()){$st.css({opacity:.7,filter:"alpha(opacity=70)"}),$st.show();var a=1/curScale;$stn.css({width:a*stBaseWidth+"px",height:a*stBaseHeight+"px",left:(1-a)*stBaseWidth/2-parseInt($stn.css("border-width")||$stn.css("borderTopWidth"))+"px",top:(1-a)*stBaseHeight/2-parseInt($stn.css("border-width")||$stn.css("borderTopWidth"))+"px"})}else $st.hide()},blankBorderLimit:function(a,b){return minL=0,minT=0,maxL=$st.width()-$stn.width(),maxT=$st.height()-$stn.height(),a=a>=minL?a:minL,b=b>=minT?b:minT,a=maxL>=a?a:maxL,b=maxT>=b?b:maxT,{stnNextL:a,stnNextT:b}},mouseDown:function(a){if(onstn){var a=a||window.event||window.e,b=a.x||a.clientX,c=a.y||a.clientY;pointerLeft=b-parseInt($stn.css("left")),pointerTop=c-parseInt($stn.css("top")),canMove=!0}},mouseMove:function(a){if(canMove){var a=a||window.event||window.e,b=a.x||a.clientX,e=a.y||a.clientY;stnNextL=b-pointerLeft,stnNextT=e-pointerTop;var f=d.blankBorderLimit(stnNextL,stnNextT);stnNextL=f.stnNextL,stnNextT=f.stnNextT,$stn.css("left",stnNextL+"px"),$stn.css("top",stnNextT+"px"),c.imgMove()}},mouseUp:function(){canMove=!1},mouseOver:function(){$sp.on("mouseover",function(){canWheel=!0}),$stn.on("mouseover",function(){onstn=!0})},mouseOut:function(){$sp.on("mouseout",function(){canWheel=!1}),$stn.on("mouseout",function(){onstn=!1})},stopDefault:function(a){var a=a||window.event||window.e;a.returnValue=!1}};return a.prototype.load=function(a){var b=a.find(".cav"),e=b.find("img"),f=a.find(".wating");a.find(".ui-dialog").css("background","none"),e.load(function(){b.show(),f.hide(),SNS.setVerticalCenter(a),c.init(),d.init(),SPsign=$sp.width()>$sc.width()/$sc.height()*$sp.height()?"width":"height"})},a.prototype.getSrcLink=function(a){var b=a.attr("src");this.imgLink=b.replace("_small",""),this.imgLinkSmall=b,this.imgLinkMiddle=b.replace("_small","_middle")},a}),define("text!im/textTpl.tpl",[],function(){return'<li class="chat-item chat-ai clearfix chat-report" data-action="surveyType=0&answerType=normal" data-timestr="" data-pid="">\n	<div class="chat-item-wrap wdwrap por clearfix">\n        <div class="chat-item-img poa">\n            <img src="//i.thsi.cn/sns/circle/img3/ai-photo.png" alt="">\n        </div>\n		<div class="chat-item-content fl p10 c444 lh24">\n			<div>征稿雄安板块分析</div>\n			<div>要求：需要赠5篇概念股的板块分析，要求客观不能荐股</div>\n			<div>奖励：文章会放在头条推荐位。</div>\n			<div class="chat-item-post btn coolbluebg fs14 tac curp mt15 mb5">立即投稿（<span class="task-last-time" data-statid="sns_work_ai.tougao" data-limitTime="1493424000">剩余1天23时51分</span>）</div>\n		</div>\n	    <div class="chat-arrow poa"></div>\n    </div>\n</li>\n'}),!function(a){a.fn.slide=function(b){return a.fn.slide.defaults={type:"slide",effect:"fade",autoPlay:!1,delayTime:500,interTime:2500,triggerTime:150,defaultIndex:0,titCell:".hd li",mainCell:".bd",targetCell:null,trigger:"mouseover",scroll:1,vis:1,titOnClassName:"on",autoPage:!1,prevCell:".prev",nextCell:".next",pageStateCell:".pageState",opp:!1,pnLoop:!0,easing:"swing",startFun:null,endFun:null,switchLoad:null,playStateCell:".playState",mouseOverStop:!0,defaultPlay:!0,returnDefault:!1},this.each(function(){var c,d=a.extend({},a.fn.slide.defaults,b),e=a(this),f=d.effect,g=a(d.prevCell,e),h=a(d.nextCell,e),i=a(d.pageStateCell,e),j=a(d.playStateCell,e),k=a(d.titCell,e),l=k.size(),m=a(d.mainCell,e),n=m.children().size(),o=d.switchLoad,p=a(d.targetCell,e),q=parseInt(d.defaultIndex),r=parseInt(d.delayTime),s=parseInt(d.interTime),t=(parseInt(d.triggerTime),parseInt(d.scroll)),u=parseInt(d.vis),v="false"==d.autoPlay||0==d.autoPlay?!1:!0,w="false"==d.opp||0==d.opp?!1:!0,x="false"==d.autoPage||0==d.autoPage?!1:!0,y="false"==d.pnLoop||0==d.pnLoop?!1:!0,z="false"==d.mouseOverStop||0==d.mouseOverStop?!1:!0,A="false"==d.defaultPlay||0==d.defaultPlay?!1:!0,B="false"==d.returnDefault||0==d.returnDefault?!1:!0,C=0,D=0,E=0,F=0,G=d.easing,H=null,I=null,J=null,K=d.titOnClassName,L=k.index(e.find("."+K)),M=q=-1==L?q:L,N=q,O=q,P=n>=u?n%t!=0?n%t:t:0,Q="leftMarquee"==f||"topMarquee"==f?!0:!1,R=function(){a.isFunction(d.startFun)&&d.startFun(q,l,e,a(d.titCell,e),m,p,g,h)},S=function(){a.isFunction(d.endFun)&&d.endFun(q,l,e,a(d.titCell,e),m,p,g,h)},T=function(){k.removeClass(K),A&&k.eq(N).addClass(K)};if("menu"==d.type)return A&&k.removeClass(K).eq(q).addClass(K),k.hover(function(){c=a(this).find(d.targetCell);var b=k.index(a(this));I=setTimeout(function(){switch(q=b,k.removeClass(K).eq(q).addClass(K),R(),f){case"fade":c.stop(!0,!0).animate({opacity:"show"},r,G,S);break;case"slideDown":c.stop(!0,!0).animate({height:"show"},r,G,S)}},d.triggerTime)},function(){switch(clearTimeout(I),f){case"fade":c.animate({opacity:"hide"},r,G);break;case"slideDown":c.animate({height:"hide"},r,G)}}),void(B&&e.hover(function(){clearTimeout(J)},function(){J=setTimeout(T,r)}));if(0==l&&(l=n),Q&&(l=2),x){if(n>=u)if("leftLoop"==f||"topLoop"==f)l=n%t!=0?(n/t^0)+1:n/t;else{var U=n-u;l=1+parseInt(U%t!=0?U/t+1:U/t),0>=l&&(l=1)}else l=1;k.html("");var V="";if(1==d.autoPage||"true"==d.autoPage)for(var W=0;l>W;W++)V+="<li>"+(W+1)+"</li>";else for(var W=0;l>W;W++)V+=d.autoPage.replace("$",W+1);k.html(V);var k=k.children()}if(n>=u){m.children().each(function(){a(this).width()>E&&(E=a(this).width(),D=a(this).outerWidth(!0)),a(this).height()>F&&(F=a(this).height(),C=a(this).outerHeight(!0))});var X=m.children(),Y=function(){for(var a=0;u>a;a++)X.eq(a).clone().addClass("clone").appendTo(m);for(var a=0;P>a;a++)X.eq(n-a-1).clone().addClass("clone").prependTo(m)};switch(f){case"fold":m.css({position:"relative",width:D,height:C}).children().css({position:"absolute",width:E,left:0,top:0,display:"none"});break;case"top":m.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; height:'+u*C+'px"></div>').css({top:-(q*t)*C,position:"relative",padding:"0",margin:"0"}).children().css({height:F});break;case"left":m.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; width:'+u*D+'px"></div>').css({width:n*D,left:-(q*t)*D,position:"relative",overflow:"hidden",padding:"0",margin:"0"}).children().css({"float":"left",width:E});break;case"leftLoop":case"leftMarquee":Y(),m.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; width:'+u*D+'px"></div>').css({width:(n+u+P)*D,position:"relative",overflow:"hidden",padding:"0",margin:"0",left:-(P+q*t)*D}).children().css({"float":"left",width:E});break;case"topLoop":case"topMarquee":Y(),m.wrap('<div class="tempWrap" style="overflow:hidden; position:relative; height:'+u*C+'px"></div>').css({height:(n+u+P)*C,position:"relative",padding:"0",margin:"0",top:-(P+q*t)*C}).children().css({height:F})}}var Z=function(a){var b=a*t;return a==l?b=n:-1==a&&n%t!=0&&(b=-n%t),b},$=function(b){var c=function(c){for(var d=c;u+c>d;d++)b.eq(d).find("img["+o+"]").each(function(){var b=a(this);if(b.attr("src",b.attr(o)).removeAttr(o),m.find(".clone")[0])for(var c=m.children(),d=0;d<c.size();d++)c.eq(d).find("img["+o+"]").each(function(){a(this).attr(o)==b.attr("src")&&a(this).attr("src",a(this).attr(o)).removeAttr(o)})})};switch(f){case"fade":case"fold":case"top":case"left":case"slideDown":c(q*t);break;case"leftLoop":case"topLoop":c(P+Z(O));break;case"leftMarquee":case"topMarquee":var d="leftMarquee"==f?m.css("left").replace("px",""):m.css("top").replace("px",""),e="leftMarquee"==f?D:C,g=P;if(d%e!=0){var h=Math.abs(d/e^0);g=1==q?P+h:P+h-1}c(g)}},_=function(a){if(!A||M!=q||a||Q){if(Q?q>=1?q=1:0>=q&&(q=0):(O=q,q>=l?q=0:0>q&&(q=l-1)),R(),null!=o&&$(m.children()),p[0]&&(c=p.eq(q),null!=o&&$(p),"slideDown"==f?(p.not(c).stop(!0,!0).slideUp(r),c.slideDown(r,G,function(){m[0]||S()})):(p.not(c).stop(!0,!0).hide(),c.animate({opacity:"show"},r,function(){m[0]||S()}))),n>=u)switch(f){case"fade":m.children().stop(!0,!0).eq(q).animate({opacity:"show"},r,G,function(){S()}).siblings().hide();break;case"fold":m.children().stop(!0,!0).eq(q).animate({opacity:"show"},r,G,function(){S()}).siblings().animate({opacity:"hide"},r,G);break;case"top":m.stop(!0,!1).animate({top:-q*t*C},r,G,function(){S()});break;case"left":m.stop(!0,!1).animate({left:-q*t*D},r,G,function(){S()});break;case"leftLoop":var b=O;m.stop(!0,!0).animate({left:-(Z(O)+P)*D},r,G,function(){-1>=b?m.css("left",-(P+(l-1)*t)*D):b>=l&&m.css("left",-P*D),S()});break;case"topLoop":var b=O;m.stop(!0,!0).animate({top:-(Z(O)+P)*C},r,G,function(){-1>=b?m.css("top",-(P+(l-1)*t)*C):b>=l&&m.css("top",-P*C),S()});break;case"leftMarquee":var d=m.css("left").replace("px","");0==q?m.animate({left:++d},0,function(){m.css("left").replace("px","")>=0&&m.css("left",-n*D)}):m.animate({left:--d},0,function(){m.css("left").replace("px","")<=-(n+P)*D&&m.css("left",-P*D)});break;case"topMarquee":var e=m.css("top").replace("px","");0==q?m.animate({top:++e},0,function(){m.css("top").replace("px","")>=0&&m.css("top",-n*C)}):m.animate({top:--e},0,function(){m.css("top").replace("px","")<=-(n+P)*C&&m.css("top",-P*C)})}k.removeClass(K).eq(q).addClass(K),M=q,y||(h.removeClass("nextStop"),g.removeClass("prevStop"),0==q&&g.addClass("prevStop"),q==l-1&&h.addClass("nextStop")),i.html("<span>"+(q+1)+"</span>/"+l)}};A&&_(!0),B&&e.hover(function(){clearTimeout(J)},function(){J=setTimeout(function(){q=N,A?_():"slideDown"==f?c.slideUp(r,T):c.animate({opacity:"hide"},r,T),M=q},300)});var ab=function(a){H=setInterval(function(){w?q--:q++,_()},a?a:s)},bb=function(a){H=setInterval(_,a?a:s)},cb=function(){z||(clearInterval(H),ab())},db=function(){(y||q!=l-1)&&(q++,_(),Q||cb())},eb=function(){(y||0!=q)&&(q--,_(),Q||cb())},fb=function(){clearInterval(H),Q?bb():ab(),j.removeClass("pauseState")},gb=function(){clearInterval(H),j.addClass("pauseState")};if(v?Q?(w?q--:q++,bb(),z&&m.hover(gb,fb)):(ab(),z&&e.hover(gb,fb)):(Q&&(w?q--:q++),j.addClass("pauseState")),j.click(function(){j.hasClass("pauseState")?fb():gb()}),"mouseover"==d.trigger?k.hover(function(){var a=k.index(this);I=setTimeout(function(){q=a,_(),cb()},d.triggerTime)},function(){clearTimeout(I)}):k.click(function(){q=k.index(this),_(),cb()}),Q){if(h.mousedown(db),g.mousedown(eb),y){var hb,ib=function(){hb=setTimeout(function(){clearInterval(H),bb(s/10^0)},150)},jb=function(){clearTimeout(hb),clearInterval(H),bb()};h.mousedown(ib),h.mouseup(jb),g.mousedown(ib),g.mouseup(jb)}"mouseover"==d.trigger&&(h.hover(db,function(){}),g.hover(eb,function(){}))
}else h.click(db),g.click(eb)})}}(jQuery),jQuery.easing.jswing=jQuery.easing.swing,jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(a,b,c,d,e){return jQuery.easing[jQuery.easing.def](a,b,c,d,e)},easeInQuad:function(a,b,c,d,e){return d*(b/=e)*b+c},easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c},easeInOutQuad:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b+c:-d/2*(--b*(b-2)-1)+c},easeInCubic:function(a,b,c,d,e){return d*(b/=e)*b*b+c},easeOutCubic:function(a,b,c,d,e){return d*((b=b/e-1)*b*b+1)+c},easeInOutCubic:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b+c:d/2*((b-=2)*b*b+2)+c},easeInQuart:function(a,b,c,d,e){return d*(b/=e)*b*b*b+c},easeOutQuart:function(a,b,c,d,e){return-d*((b=b/e-1)*b*b*b-1)+c},easeInOutQuart:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b+c:-d/2*((b-=2)*b*b*b-2)+c},easeInQuint:function(a,b,c,d,e){return d*(b/=e)*b*b*b*b+c},easeOutQuint:function(a,b,c,d,e){return d*((b=b/e-1)*b*b*b*b+1)+c},easeInOutQuint:function(a,b,c,d,e){return(b/=e/2)<1?d/2*b*b*b*b*b+c:d/2*((b-=2)*b*b*b*b+2)+c},easeInSine:function(a,b,c,d,e){return-d*Math.cos(b/e*(Math.PI/2))+d+c},easeOutSine:function(a,b,c,d,e){return d*Math.sin(b/e*(Math.PI/2))+c},easeInOutSine:function(a,b,c,d,e){return-d/2*(Math.cos(Math.PI*b/e)-1)+c},easeInExpo:function(a,b,c,d,e){return 0==b?c:d*Math.pow(2,10*(b/e-1))+c},easeOutExpo:function(a,b,c,d,e){return b==e?c+d:d*(-Math.pow(2,-10*b/e)+1)+c},easeInOutExpo:function(a,b,c,d,e){return 0==b?c:b==e?c+d:(b/=e/2)<1?d/2*Math.pow(2,10*(b-1))+c:d/2*(-Math.pow(2,-10*--b)+2)+c},easeInCirc:function(a,b,c,d,e){return-d*(Math.sqrt(1-(b/=e)*b)-1)+c},easeOutCirc:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c},easeInOutCirc:function(a,b,c,d,e){return(b/=e/2)<1?-d/2*(Math.sqrt(1-b*b)-1)+c:d/2*(Math.sqrt(1-(b-=2)*b)+1)+c},easeInElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g))+c},easeOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(1==(b/=e))return c+d;if(g||(g=.3*e),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*b)*Math.sin(2*(b*e-f)*Math.PI/g)+d+c},easeInOutElastic:function(a,b,c,d,e){var f=1.70158,g=0,h=d;if(0==b)return c;if(2==(b/=e/2))return c+d;if(g||(g=.3*e*1.5),h<Math.abs(d)){h=d;var f=g/4}else var f=g/(2*Math.PI)*Math.asin(d/h);return 1>b?-.5*h*Math.pow(2,10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g)+c:h*Math.pow(2,-10*(b-=1))*Math.sin(2*(b*e-f)*Math.PI/g)*.5+d+c},easeInBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*(b/=e)*b*((f+1)*b-f)+c},easeOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),d*((b=b/e-1)*b*((f+1)*b+f)+1)+c},easeInOutBack:function(a,b,c,d,e,f){return void 0==f&&(f=1.70158),(b/=e/2)<1?d/2*b*b*(((f*=1.525)+1)*b-f)+c:d/2*((b-=2)*b*(((f*=1.525)+1)*b+f)+2)+c},easeInBounce:function(a,b,c,d,e){return d-jQuery.easing.easeOutBounce(a,e-b,0,d,e)+c},easeOutBounce:function(a,b,c,d,e){return(b/=e)<1/2.75?7.5625*d*b*b+c:2/2.75>b?d*(7.5625*(b-=1.5/2.75)*b+.75)+c:2.5/2.75>b?d*(7.5625*(b-=2.25/2.75)*b+.9375)+c:d*(7.5625*(b-=2.625/2.75)*b+.984375)+c},easeInOutBounce:function(a,b,c,d,e){return e/2>b?.5*jQuery.easing.easeInBounce(a,2*b,0,d,e)+c:.5*jQuery.easing.easeOutBounce(a,2*b-e,0,d,e)+.5*d+c}}),define("jquery/SuperSlide/2.1.1/SuperSlide",[],function(){return $}),define("SuperSlide",function(){}),define("im/touguai",["tinyscrollbar","EditorSmall","text!im/ai.tpl","text!im/workbenchai.tpl","zoomImg","text!im/textTpl.tpl","SuperSlide"],function(a,b,c,d,e,f){function g(a){var b={type:"AI",conEle:"im-wrap"};this.opts=$.extend(b,a),this.init()}g.prototype.init=function(){var a=this;a.initParam(),a.appendDom(),a.initEditor(),a.robotsEvent(),a.initUserAndRobotImg()},g.prototype.initParam=function(){var a=this;a.type=a.opts.type,a.$containerEle=$("."+a.opts.conEle),a.showType="sq",a.hasPersonReply=!1,a.guideMode="",a.feedBackText="您可以简单描述下原因：",a.chartColorArr=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],SNS.citeJS(["//s.thsi.cn/sns/sea-modules/gallery/echarts/echarts-debug.min.3.4.0.js"])},g.prototype.addTest=function(){var a=this;a.$aiwrap.find(".chat-wrap").append(f)},g.prototype.appendDom=function(){var a=this;"AI"==a.type?(a.$containerEle.append(c),a.$robots=$(".ai-robots"),a.$aiwrap=$(".ai-wrap")):(a.$containerEle.append(d),a.$robots=$(".workbenchai-top"),a.$aiwrap=$(".workbenchai-wrap"),a.msgRender(),a.roundMsg())},g.prototype.initEditor=function(){var a=this,c={placeholderText:"",$container:a.$aiwrap.find(".askbox-active .editor-container"),topic:!1,wordlimit:-1};a.editorSmall=new b(c),a.$aiwrap.find(".editor-small-btn").removeAttr("href").addClass("curp"),a.scrollInit(),a.aiscrollbarData.update("bottom")};var h=!0;g.prototype.robotsEvent=function(){var a,b,c=this;initSucCallback=function(a){if(c.$aiwrap.show(),0===a.errorCode){if(c.$aiwrap.find(".chat-item-kong").before(a.result.guideHtml||a.result.artificialHtml||a.result.reportHtml),a.result.artificialHtml?c.$aiwrap.find(".chat-personReply").eq(0).addClass("chat-guide"):a.result.reportHtml&&"workbench"==c.type&&c.$aiwrap.find(".chat-report").eq(0).addClass("chat-guide"),"undefined"!=typeof a.result.chatHtml&&a.result.chatHtml.length){var b=parseInt((new Date).getTime()/1e3),d=c.$aiwrap.find(".chat-guide");d.attr("data-timestr",timeStrConvert(b)).before(a.result.chatHtml);var e,f=c.$aiwrap.find(".viewport").height();if(d.length){e=c.$aiwrap.find(".overview").outerHeight()-d.position().top+25;var g=f-e,i=c.$aiwrap.find(".chat-item-kong");f>e&&!i.hasClass("heightInit")&&i.height(g).addClass("heightInit")}}else c.$aiwrap.find(".chat-wrap").attr("data-hisdata","0");$(".ai-info").hide(),c.initDiagram()}c.setOldDataTimeStr(),setTimeout(function(){c.aiscrollbarData.update(c.$aiwrap.find(".chat-guide").position().top-27)},100),c.initGuide(),c.taskTimer(),c.animateWrap("zk"),h=!1},"AI"==c.type?b={pid:0,from:1}:"workbench"==c.type&&(b={pid:0,from:2}),c.$robots.on("click",function(){if(!SNS.getUserid())return $("#J_Login").trigger("click"),!1;h?(c.$aiwrap.find(".workbenchai-top-intro").hide(),c.getChatFlowAjax(b,initSucCallback),c.bindEvent()):(c.hasPersonReply&&"AI"==c.type&&(b={pid:0,from:1},a=function(a){0===a.errorCode&&(a.result.artificialHtml&&a.result.artificialHtml.length&&(c.$aiwrap.find(".chat-wrap").append(a.result.artificialHtml),c.aiscrollbarData.update("bottom"),c.hasPersonReply=!1,$(".chat-item-kong").length&&c.$aiwrap.find(".chat-item-kong").remove()),$(".ai-info").hide(),c.initDiagram(),c.taskTimer())},c.getChatFlowAjax(b,a)),c.animateWrap("zk"));var d="sns_zntg_tob";"AI"==c.opts.type&&(d="sns_zntg_toc"),TA.log({id:"sns_zntg",fid:d,_sid:"sns_zntg_all"})}),c.$aiwrap.find(".workbenchai-top-bubble,.workbenchai-top-intro").on("click",function(){return disappearBubble(),$(".workbenchai-top-intro").hide(),h||"workbench"!=c.type?void 0:("sq"==c.showType&&c.animateWrap(),c.getChatFlowAjax(b,c.handleAjax),!1)})},g.prototype.initUserAndRobotImg=function(){var a=this,b=$(".im-block-avatar").attr("src")||$(".wb-circleavatar img").attr("src");a.userImg=b,a.robotImg="workbench"==a.type?"//i.thsi.cn/sns/circle/img3/ai-photo.png":"//i.thsi.cn/sns/circle/img2/touguai/tougu-robots.20170109.png"},g.prototype.bindEvent=function(){var a,b,c,d,f=this;f.$aiwrap.delegate(".chat-ai .chat-ai-select .chat-select-option","click",function(){var e=$(this).parents(".chat-item"),g=e.attr("data-pid");if(b=f.setAiQAType(2,{msg1:$(this).html()}),d=" hide",c="",$(this).attr("data-href").length>0&&(c=$(this).attr("data-href"),d=""),a=f.setAiQAType(3,{msg1:$(this).attr("data-answer"),msg2:c,msg3:d}),f.$aiwrap.find(".chat-item-kong").remove(),f.$aiwrap.find(".chat-wrap").append(b),"AI"==f.type){$('[data-forpid="'+g+'"]').remove();var h="";e.attr("data-surveylock")&&"lock"===e.attr("data-surveylock")||(h=f.setAiQAType(4,{forpid:g})),f.$aiwrap.find(".chat-wrap").append(a+h)}else f.$aiwrap.find(".chat-wrap").append(a);f.aiscrollbarData.update("bottom")}),f.$aiwrap.on("click","a",function(){"javascript:void(0);"!==$.trim($(this).attr("href"))&&$(this).attr("target","_blank")}),f.$aiwrap.find(".askbox-input,.askbox-btn").on("click",function(a){a.stopPropagation(),a.preventDefault(),$(this).parent(".askbox-normal").hide(),f.$aiwrap.find(".askbox-active").show(),$(this).parents(".ai-answerbox").addClass("ai-answerbox-active"),f.$aiwrap.find("textarea").focus()}),f.$aiwrap.on("click",function(a){var b=$(a.target);b.parents(".ai-answerbox").length||b.parents(".chat-survey").length||($(".askbox-active").hide(),f.$aiwrap.find(".ai-answerbox").removeClass("ai-answerbox-active"),$(".askbox-normal").show())}),$(document).keydown(function(a){return 13==a.which&&$(document.activeElement).parents(".askbox-active").length?(f.$aiwrap.find(".editor-small-btn").trigger("click"),!1):void 0});var g,h,i=!0,j=!0;if($("#scrollbarWrap-touguai").bind("move",function(){if(g=$("#scrollbarWrap-touguai").data("plugin_tinyscrollbar"),g.thumbPosition<=5&&i){if("0"===f.$aiwrap.find(".chat-wrap").attr("data-hisdata"))return!1;i=!1,h=f.$aiwrap.find(".chat-item").eq(0);var a={pid:h.attr("data-pid"),from:"AI"==f.type?1:2},b=function(a){0===a.errorCode&&("undefined"!=typeof a.result.chatHtml&&a.result.chatHtml.length?(h.before(a.result.chatHtml),f.aiscrollbarData.update(h.position().top),f.setOldDataTimeStr()):f.$aiwrap.find(".chat-wrap").attr("data-hisdata","0"),f.initDiagram(),f.taskTimer())},c=function(){i=!0};f.getChatFlowAjax(a,b,c)}g.viewportSize-g.thumbPosition-g.thumbSize<=5&&j&&(j=!1,f.aiscrollbarData.update("bottom"),j=!0)}),f.$aiwrap.find(".editor-small-btn").on("click",function(){var a={question:$.trim(f.$aiwrap.find(".editor-textarea").val())};0===a.question.indexOf(f.feedBackText)&&f.feedbackPid&&(a.pid=f.feedbackPid),f.formatQsAjax(a)}),new e(f.$aiwrap),f.$aiwrap.on("click",".ai-auto-qs",function(){var a,b,c=$(this).parents(".chat-item-content");if(f.$aiwrap.find(".chat-item-kong").length&&f.$aiwrap.find(".chat-item-kong").remove(),$(this).hasClass("report-item"))b=$(this).attr("data-date"),a=$(".report-item-"+b).html(),c.find(".ai-auto-qs").removeClass("active"),$(this).addClass("active"),c.find(".chat-ai-item-content").html(a);else{a=$(this).text(),f.guideMode=$(this).parent().find(".intro-title").attr("data-mode"),$(".askbox-btn").trigger("click"),f.$aiwrap.find(".editor-textarea").val(a),f.$aiwrap.find(".editor-small-btn").trigger("click"),f.aiscrollbarData.update("bottom");var d=$(this).index(),e=$(this).parents(".slider-item:not(.clone)").index(),g="workbench"==f.type?"tob":"toc",h="sns_zntg_"+g+"_shouping"+e+"."+d,i="sns_zntg_"+g+"_shouping"+e+",sns_zntg_"+g+"_shouping";TA.log({id:h,fid:i})}}),f.$aiwrap.on("click",".watchMoreCode",function(){var a=$(this).attr("href");a+=$.trim($(this).parents(".chat-item").prev().text()),$(this).prop("href",a)}),"AI"==f.type){f.$aiwrap.delegate(".chat-guide .chat-select-option","click",function(){var a=$(this).html();f.formatQsAjax({question:$.trim(a)})});var k,l;f.$aiwrap.delegate(".chat-survey-item","click",function(){var a={pid:parseInt($(this).parents(".chat-survey").attr("data-forpid"))},b="",c="";if($(this).hasClass("manyi")){b="满意",c="非常感谢您的评价",a.issatisfied=1;var d=f.editorSmall.getContent();0===d.indexOf(f.feedBackText)&&(f.editorSmall.reset(),f.feedbackPid=0)}else{if(b="不满意",c="请您告诉我不满意的原因，您的反馈能让18号更好的为您服务！",a.issatisfied=-1,navigator.userAgent.indexOf("MSIE")>-1){f.$aiwrap.find(".editor-textarea").append(f.feedBackText),f.$aiwrap.find(".askbox-btn").trigger("click");var e=f.$aiwrap.find(".editor-textarea").get(0).createTextRange();e.moveStart("character",f.feedBackText.length),e.collapse(!0),e.select()}else f.editorSmall.insertTextFocus(f.feedBackText);f.feedbackPid=a.pid}var g=!1;if(g)return!1;$.ajax({url:"/newcircle/chat/dealFeedback/",type:"get",dataType:"json",data:a,beforeSend:function(){g=!0},success:function(b){0===b.errorCode?$('[data-pid="'+a.pid+'"]').attr("data-surveylock","lock"):SNS.alertBox({type:"error",tipContent:b.errorMsg})},complete:function(){g=!1}}),$(this).parents(".chat-item").remove(),k=f.setAiQAType(2,{msg1:b}),l=f.setAiQAType(1,{msg1:c}),f.$aiwrap.find(".chat-wrap").append(k),f.$aiwrap.find(".chat-wrap").append(l),f.aiscrollbarData.update("bottom");var h=f.$aiwrap.find(".ai-answerbox");!h.hasClass("ai-answerbox-active")&&$(this).hasClass("bumanyi")&&h.find(".askbox-input").trigger("click")}),f.$aiwrap.find(".ai-top-close").on("click",function(){f.animateWrap("sq")})}else f.$aiwrap.on("click",".chat-item-post",function(){$(this).hasClass("disabled")||($(this).hasClass("chat-post-send")?($(".J_NewEditorLabel").attr("data-taskpost","5621"),$(".send-post").trigger("click")):window.open($(this).attr("data-href")))})},g.prototype.setUsername=function(){var a=this,b=a.$containerEle.find(".im-avatar-wrap .im-block-title").text();b.length&&a.$aiwrap.find(".ai-username").html(b)},g.prototype.scrollInit=function(){var a=this;$("#scrollbarWrap-touguai").tinyscrollbar(),a.aiscrollbarData=$("#scrollbarWrap-touguai").data("plugin_tinyscrollbar")};var i={old:3600,"new":60};g.prototype.setOldDataTimeStr=function(){var a,b,c,d,e,f,g=this,h=i.old,j=g.$aiwrap.find(".chat-item");j.each(function(a){return $(this).hasClass("chat-guide")?void(f=a):void 0}),$(".chat-timeline").eq(0).hasClass("chat-his-line")||$(".chat-timeline").eq(0).remove();for(var k=f;k>=0;k--)if(e=parseInt((new Date).getTime()/1e3),c=$(j.get(k)),a=parseInt(c.attr("data-timestr")),0!==k||c.hasClass("chat-guide")||c.prev().hasClass("chat-timeline"))if(!c.hasClass("chat-guide")||c.prev().hasClass("chat-timeline"))d=j.eq(k-1),b=parseInt(d.attr("data-timestr")),a-b>h&&!c.prev().hasClass("chat-timeline")&&c.before('<li class="chat-timeline por" data-timestr="'+a+'"><div class="time-box poa">'+timeStrConvert(a)+"</div></li>");else{var l="以上是历史记录";"0"===g.$aiwrap.find(".chat-wrap").attr("data-hisdata")&&(l="最近没有历史记录"),c.before('<li class="chat-timeline por chat-his-line" data-timestr=""><div class="time-box poa">'+l+"</div></li>")}else c.before('<li class="chat-timeline por" data-timestr="'+a+'"><div class="time-box poa">'+timeStrConvert(a)+"</div></li>")},g.prototype.setNewDataTimeStr=function(){var a,b,c,d,e,f,g=this,h=i["new"],j=g.$aiwrap.find(".chat-item");j.each(function(a){return $(this).hasClass("chat-guide")?void(f=a):void 0});for(var k=j.length-1;k>f;k--)d=parseInt((new Date).getTime()/1e3),c=$(j.get(k)),a=parseInt(c.attr("data-timestr")),e=j.eq(k-1),b=parseInt(e.attr("data-timestr")),a-b>h&&!c.prev().hasClass("chat-timeline")&&c.before('<li class="chat-timeline por" data-timestr="'+a+'"><div class="time-box poa">'+timeStrConvert(a)+"</div></li>")},g.prototype.animateWrap=function(a){var b=this;"AI"==b.type?"zk"==a?b.$robots.animate({left:"10px"},200,"swing",function(){b.$aiwrap.stop().show().animate({left:-1*b.$aiwrap.find(".ai-con").width()+"px"},300,function(){b.$robots.hide(),b.$aiwrap.find(".ai-triangle").show(),b.showType="zk",b.aiscrollbarData.update("bottom")})}):(b.$robots.find(".ai-triangle").hide(),b.$aiwrap.stop().animate({left:"0"},300,"swing",function(){b.$aiwrap.hide(),b.$robots.show().animate({left:-1*b.$robots.width()},200),b.showType="sq"})):"workbench"==b.type&&("zk"==b.showType?(TA.log({id:"sns_zntg_tob_shouqi"}),b.$aiwrap.find("#aiCloseBtn").removeClass("close-down").addClass("close-up"),b.$aiwrap.stop().animate({bottom:"2px"},200,"swing",function(){b.showType="sq",b.aiscrollbarData.update("bottom")})):(b.$aiwrap.find("#aiCloseBtn").removeClass("close-up").addClass("close-down"),b.$aiwrap.stop().animate({bottom:b.$aiwrap.height()-$(".workbenchai-top").outerHeight()},300,"swing",function(){b.showType="zk"}),TA.log({id:"sns_zntg_tob_zhankai"})))};var j=!0;g.prototype.formatQsAjax=function(a){var b=this;if(0===$.trim(a.question).length){var c=b.setAiQAType(1,{msg1:"发送内容不能为空哦....."});return b.$aiwrap.find(".chat-wrap").append(c),$(".chat-item-kong").length&&b.$aiwrap.find(".chat-item-kong").remove(),b.aiscrollbarData.update("bottom"),!1}if(!j)return!1;var d=b.setAiQAType(0,{msg1:"正在思考中..."});j=!1,$.ajax({url:"/newcircle/chat/formatQuestion/",type:"get",dataType:"json",data:a,success:function(c){if(0===c.errorCode){$(".chat-item-kong").length&&b.$aiwrap.find(".chat-item-kong").remove(),b.$aiwrap.find(".chat-wrap").append(c.result);var e=b.$aiwrap.find(".chat-item").last();b.$aiwrap.find(".chat-user .chat-item-img img").attr("src",b.userImg),b.$aiwrap.find(".editor-textarea").val(""),b.$aiwrap.find(".chat-wrap").append(d),b.aiscrollbarData.update("bottom"),b.getAskQsAjax(a,e)}else SNS.alertBox({type:"error",tipContent:c.errorMsg})},complete:function(){j=!0}})};var k=!0;g.prototype.getAskQsAjax=function(a,b){var c=this;if(k){if("AI"==c.type?a.from=1:"workbench"==c.type&&(a.from=2),c.guideMode.length){var d=[c.guideMode];a.mode=d,c.guideMode=""}k=!1,$.ajax({url:"/newcircle/chat/assistant/",type:"get",dataType:"json",data:a,success:function(a){if(0===a.errorCode){var d=a.result.answerHtml,e=a.result.pid,f=a.result.time;setTimeout(function(){c.$aiwrap.find(".chat-think").remove(),c.$aiwrap.find(".chat-wrap").append(d),c.initDiagram(),c.setSurvey(d),b.attr("data-timestr",f),b.attr("data-pid",e),c.setNewDataTimeStr(),c.aiscrollbarData.update("bottom"),c.$aiwrap.find(".chat-item").last().find("img").length&&setTimeout(function(){c.aiscrollbarData.update("bottom")},200)},300)}else c.$aiwrap.find(".chat-think").length&&c.$aiwrap.find(".chat-think").remove(),SNS.alertBox({type:"error",tipContent:a.errorMsg})},complete:function(){k=!0,TA.log({id:"sns_zntg.send"})}})}},g.prototype.setSurvey=function(a){var b,c=this;if(a.indexOf("surveyType=1")>-1&&"AI"==c.type){var d=c.$aiwrap.find(".chat-item").last().attr("data-pid");c.$aiwrap.find(".chat-survey").length&&c.$aiwrap.find(".chat-survey").remove(),b=c.setAiQAType(4,{forpid:d})}c.$aiwrap.find(".chat-wrap").append(b)},g.prototype.setAiQAType=function(a,b){var c=this,d="";return 0===a?d=['<li class="chat-item chat-ai chat-think clearfix" data-action="surveyType=0&answerType=normal" data-timestr="" data-pid="">','<div class="chat-item-wrap wdwrap por clearfix">','<div class="chat-item-img poa">','<img src="'+c.robotImg+'" alt="">',"</div>",'<div class="chat-item-content fl p10">'+b.msg1+"</div>",'<div class="chat-arrow poa"></div>',"</div>","</li>"].join(""):1===a?d=['<li class="chat-item chat-ai clearfix" data-action="surveyType=0&answerType=normal" data-timestr="" data-pid="">','<div class="chat-item-wrap wdwrap por clearfix">','<div class="chat-item-img poa"><img src="'+c.robotImg+'" alt=""></div>','<div class="chat-item-content p10 fl">'+b.msg1+"</div>",'<div class="chat-arrow poa"></div>',"</div>","</li>"].join(""):2===a?d=['<li class="chat-item chat-user clearfix" data-timestr="" data-pid="">','<div class="chat-item-wrap wdwrap por clearfix">','<div class="chat-item-img poa">','<img src="'+c.userImg+'" alt="">',"</div>",'<div class="chat-user-content">'+b.msg1+"</div>",'<div class="chat-arrow"></div>',"</div>","</li>"].join(""):3===a?d=['<li class="chat-item chat-ai clearfix">','<div class="chat-item-wrap">','<div class="chat-ai-normal">','<div class="chat-item-content">'+b.msg1+"</div>",'<a data-statid="sns_zntg.baikemore" href="'+b.msg2+'" target="_blank" class="chat-normal-detail bluetext '+b.msg3+'"><span class=""></span>查看详情</a>',"</div>",'<div class="chat-arrow"></div>',"</div>","</li>"].join(""):4===a&&(d=['<li class="chat-item chat-survey" data-forpid="'+b.forpid+'">','<div class="chat-item-wrap clearfix tac">','<div class="dib chat-survey-item manyi" data-statid="sns_zntg.fxjg.manyi">满意</div>','<div class="dib chat-survey-item bumanyi" data-statid="sns_zntg.fxjg.bumanyi">不满意</div>',"</div>","</li>"].join("")),d},g.prototype.initDiagram=function(){var a=this;$('[data-initDiagramLock="0"]').each(function(){var b=$(this),c=b.find(".diagram-data").text();if($.trim(c).length&&-1===navigator.userAgent.indexOf("IE")){var d=$.parseJSON(c);"pie"==d.type?a.initPieChart(d,b.find(".diagram-con")):a.lineOrBarInit(d,b.find(".diagram-con"))}b.attr("data-initDiagramLock","1")})},g.prototype.lineOrBarInit=function(a,b){var c,d,e,f,g,h,i=this,j=[],k=[],l=[],m=[],n={},o=0,p=a;try{if(0===p.series.length)return}catch(q){return}p.title&&j.push('<div class="chart_top_title">'+p.title+"</div>"),j.push('<ul class="chart_top_legend_list clearfix">');for(var r=0,s=p.series.length;s>r;r++){if(k.push(p.series[r].name),g=p.series[r].unit?p.series[r].unit:" ",0===r)o++,n[g]=o-1,l.push({name:g,nameGap:5,scale:!0}),k.push(p.series[r].name),p.series[r].yAxisIndex=o-1,m.push(p.series[r]);else if("undefined"==typeof n[g]){if(o>=2)continue;o++,n[g]=o-1,l.push({name:g,nameGap:5,scale:!0}),k.push(p.series[r].name),p.series[r].yAxisIndex=o-1,m.push(p.series[r])}else k.push(p.series[r].name),p.series[r].yAxisIndex=n[g],m.push(p.series[r]);e=i.chartColorArr[r%i.chartColorArr.length],j.push('<li l_name="'+p.series[r].name+'" class="chart_top_legend_item selected_legend_item">'),j.push('<span class="icon" bg="'+e+'" style="background-color:'+e+'"></span><span class="name">'+p.series[r].name+"</span></li>")}j.push("</ul>"),h=1===o?0:40,c=$('<div class="chart_item_con"><div class="chart_top_info">'+j.join("")+'</div><div class="chart_box_outer"><div class="chart_box"></div></div></div>'),c.appendTo(b),d=c.find(".chart_box"),f=echarts.init(d[0]),f.setOption({title:{show:!1},legend:{show:!1},xAxis:{data:p.xAxis[0].data},yAxis:l,grid:{top:20,bottom:20,left:40,right:h},series:m,color:i.chartColorArr}),i.dispatchChartLegend({chartObj:f,con:c})},g.prototype.initPieChart=function(a,b){var c,d,e,f,g,h,i=this,j=[],k=[];g=a,g.title&&j.push('<div class="chart_top_title">'+g.title+"</div>"),j.push('<ul class="chart_top_legend_list clearfix">'),h=g.series[0].data;for(var l=0,m=h.length;m>l;l++)k.push(h[l].name),e=i.chartColorArr[l%i.chartColorArr.length],j.push('<li l_name="'+h[l].name+'" class="chart_top_legend_item selected_legend_item">'),j.push('<span class="icon" bg="'+e+'" style="background-color:'+e+'"></span><span class="name">'+h[l].name+"</span></li>");j.push("</ul>"),c=$('<div class="chart_item_con"><div class="chart_top_info">'+j.join("")+'</div><div class="chart_box_outer"><div class="chart_box"></div></div></div>'),c.appendTo(b),d=c.find(".chart_box"),f=echarts.init(d[0]),f.setOption({title:{show:!1},legend:{show:!1},series:[{name:g.title,type:g.type,radius:"75%",center:["50%","55%"],data:g.series[0].data,label:{normal:{show:!1}},labelLine:{normal:{length:5,length2:5}}}],tooltip:{trigger:"item",formatter:"{a}<br/>{b}:{c} ({d}%)",position:function(){return[0,"23%"]},textStyle:{fontSize:8}}}),i.dispatchChartLegend({chartObj:f,con:c})},g.prototype.dispatchChartLegend=function(a){var b=a.chartObj,c=a.con;c.on("click",".chart_top_legend_item",function(){var a=$(this).attr("l_name"),c=$(this).find(".icon");$(this).hasClass("unselected_legend_item")?(b.dispatchAction({type:"legendSelect",name:a}),$(this).removeClass("unselected_legend_item"),c.css("background",c.attr("bg"))):(b.dispatchAction({type:"legendUnSelect",name:a}),$(this).addClass("unselected_legend_item"),c.css("background","#ccc"))})},g.prototype.initGuide=function(){$(".chat-guide-recommend").length&&$(".chat-guide-recommend").slide({mainCell:".bd",effect:"leftLoop",autoPlay:!0,vis:1,interTime:5e3})};var l=!0;return g.prototype.getChatFlowAjax=function(a,b,c){var d=this;l&&(l=!1,$.ajax({url:"/newcircle/chat/getChatFlow/",type:"get",dataType:"json",data:a,success:function(a){$.isFunction(b)&&b(a,d)},complete:function(){l=!0,$.isFunction(c)&&c(),d.$aiwrap.find(".chat-user .chat-item-img img").attr("src",d.userImg)}}))},g.prototype.personReply=function(a){var b=this;"sq"===b.showType&&a>0&&($(".ai-info").show(),b.hasPersonReply=!0)},g.prototype.taskTimer=function(){var a=this;a.$aiwrap.find(".task-last-time").length&&a.$aiwrap.find(".task-last-time").each(function(){var b=$(this),c=parseInt(b.attr("data-limitTime"));c?(b.html(timeFormat(c)),setInterval(function(){b.html(timeFormat(c))},6e4)):a.$aiwrap.find(".chat-item-post").addClass("disabled").html("停止投稿")})},g.prototype.msgRender=function(){var a=this,b="";$.ajax({url:"/newcircle/chat/getLatestUnread/",type:"get",dataType:"json",data:b}).done(function(b){if(0===b.errorCode){var c=b.result.unread;0===c?(a.$aiwrap.find(".workbenchai-top-intro").hide(),a.$aiwrap.find(".workbenchai-top-intro").attr("data-hasNew","0"),$(".workbench-right-switch-ai").removeClass("swingai").attr("title","暂无消息")):(a.$aiwrap.find(".workbenchai-top-intro").show(),a.$aiwrap.find("#newDataNum").html(c),a.$aiwrap.find(".workbenchai-top-intro").attr("data-hasNew","1"),$(".workbench-right-switch-ai").addClass("swingai").attr("title","有新消息"),b.result.html&&(setTimeout(function(){a.$aiwrap.find(".workbenchai-top-bubble").empty().append(b.result.html).css({opacity:0,top:"0",display:"block"}).animate({opacity:1,top:"-84px"},500)},1e3),setTimeout(function(){disappearBubble()},5e3)))}})},g.prototype.roundMsg=function(){var a=this;setInterval(function(){a.msgRender()},3e5)},g.prototype.handleAjax=function(a,b){if(a.result.reportHtml){b.$aiwrap.find(".chat-item-kong").length&&b.$aiwrap.find(".chat-item-kong").remove();var c=$(a.result.reportHtml);c.appendTo(b.$aiwrap.find(".chat-wrap")),b.aiscrollbarData.update("bottom")}},g}),define("im/im",["tinyscrollbar","artTemplate","text!im/li.tpl","text!im/lidetail.tpl","text!im/html.tpl","store","rewardMsg","im/touguai"],function(a,b,c,d,e,f,g,h){function i(){this.wrap=$("#im-wrap"),this.mineFlag=!0,this.init()}function j(){var a=document.all?!0:!1,b=!1;return a&&navigator.userAgent.indexOf("MSIE 8.0")>1&&(b=!0),b}function k(){if(j()){var a=$(window).height();$(".im-menu").css("height",a),$(".im-body").css("height",a)}}function l(){SNS.isIE6()&&$(window).on("scroll",function(){var a=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;$(".im-wrap").css("top",61+parseInt(a)+"px")})}function m(a){var b=[];try{f.set("juadvertisement","")}catch(c){}$(".juadvertisementflag").length||(b.push('<div class="juadvertisementflag tac mt10 bbs pb10">','<div class="fz14 mb10">以下策略今天有新动态</div>',"<div>T策略基于模拟炒股进行交易操作，仅供教学和游戏，不能作为您实盘操作的依据，请注意风险。</div>","</div>"),a.before(b.join("")))}var n=SNS.Cookies.get("userid");return window.imscrollbarData="",i.prototype.init=function(){var a=this;this.renderTemplate(),this.setViewport(),this.ieFix(),this.leftBindEvent(),n?(this.avatarInit(),this.infoBindEvent(),this.jubaoBindEvent(),this.msgBindEvent(),this.sysMsgBindEvent(),this.visitLog(),this.bindEvent(),$("#im-scrollbar").tinyscrollbar(),window.imscrollbarData=$("#im-scrollbar").data("plugin_tinyscrollbar"),"undefined"!=typeof window.loginUserJson?($("[tabname=info] .im-block-title").text(window.loginUserJson.nickname),a.msgAround()):a.msgAround(1),a.Around()):($(".im-body").hide(),$("#im-wrap").click(function(){return $("#J_Login").trigger("click"),!1})),i.touguAIObj=new h},i.prototype.renderTemplate=function(){var a=b.compile(e),c=a({});$("body").append(c),this.wrap=$("#im-wrap")},i.prototype.avatarInit=function(){var a=SNS.getUserid();$(".im-block-avatar").attr("src","//u.thsi.cn/avatar/"+a.slice(-4)+"/"+a+".gif")},i.prototype.scrollbarUpdate=function(){try{window.imscrollbarData=$("#im-scrollbar").data("plugin_tinyscrollbar"),window.imscrollbarData.update("relative")}catch(a){}},i.prototype.bindEvent=function(){var a=this;$(document).click(function(b){$(b.target).closest("#im-wrap").length||"im-3"==a.wrap.attr("im-state")&&a.turnState("im-1")})},i.prototype.turnState=function(a){var b=this,c=44,d=125,e=0,f=270;switch(a){case"im-1":b.wrap.attr("im-state","im-1"),$(".im-menu").stop().animate({width:c},350),$(".im-body").stop().animate({width:e},350),$(".im-icon-close").hide(),$(".im-history-ol").hide(),$(".im-block").removeClass("cur-block"),$(".im-history").fadeIn(300),$(".im-wrap").removeClass("im-wrap-in");break;case"im-2":b.wrap.attr("im-state","im-2"),$(".im-menu").stop().animate({width:d},350),$(".im-body").stop().animate({width:e},350),$(".im-icon-close").hide(),$(".im-history-ol").show(),$(".im-wrap").addClass("im-wrap-in");break;case"im-3":b.wrap.attr("im-state","im-3"),$(".im-menu").stop().animate({width:c},350),$(".im-body").stop().animate({width:f},350),$(".im-icon-close").show(),$(".im-history-ol").hide(),$(".im-history").fadeOut(300),$(".im-wrap").addClass("im-wrap-in")}},i.prototype.isLogin=function(){var a=SNS.Cookies.get("userid");return a?!0:($("#J_Login").trigger("click"),!1)},i.prototype.leftBindEvent=function(){function a(a,c,d){var e=a.eq(d).attr("tabname");if(b.isLogin())if("im-3"!=b.wrap.attr("im-state")&&b.turnState("im-3"),"info"==e){$(".im-body-list-info .im-info-content").length||b.infoAjax();var f=SNS.getUserid();f!=n&&(b.avatarInit(),b.infoAjax(),n=SNS.getUserid()),b.scrollbarUpdate("relative")}else if("ju"==e)a.eq(d).find(".im-icon-redcircle").hide(),b.juAjax();else if("msg"==e){a.eq(d).find(".im-icon-redcircle").hide();var g=b.wrap.find("[msgtabname=strategy] .im-icon-redcircle").css("display"),h=b.wrap.find("[msgtabname=chat] .im-icon-redcircle").css("display"),i=b.wrap.find("[msgtabname=post] .im-icon-redcircle").css("display");"block"==g?b.wrap.find("[msgtabname=strategy]").trigger("click"):"block"==h?b.wrap.find("[msgtabname=chat]").trigger("click"):"block"==i?b.wrap.find("[msgtabname=post]").trigger("click"):b.wrap.find("[msgtabname=strategy]").trigger("click")}else"sysmsg"==e&&(a.eq(d).find(".im-icon-redcircle").hide(),b.msgAjaxSys())}var b=this;$(".im-menu").hover(function(){"im-3"!=b.wrap.attr("im-state")&&b.turnState("im-2")},function(){"im-2"==b.wrap.attr("im-state")&&b.turnState("im-1")}),$(".im-icon-close").click(function(){"im-3"==b.wrap.attr("im-state")&&b.turnState("im-1")}),$(".im-block").hover(function(){$(this).parent().hasClass("im-history")||$(this).css("backgroundColor","#d7d7d7")},function(){$(this).css("backgroundColor","")});var c={navEle:"#im-wrap .im-block-tab",activeClass:"cur-block",contentEle:"#im-wrap .im-body-list",triggerMode:"click",repeat:!1,callback:a};new SNS.Tab(c)},i.prototype.infoBindEvent=function(){var a=this;$(".im-fans a").on("click",a.wrap,function(){$(this).parent().find("i").hide()})},i.prototype.jubaoBindEvent=function(){var a=this;$(this.wrap).delegate(".im-ju-show","click",function(){var b=SNS.strToObject($(this).attr("data-action")),c=$(this).parents("li");a.juDetailAjax(b,c),$(".im-ju-list-wrap",c).show(),$(this).text("收起").removeClass("im-ju-show").addClass("im-ju-hide")}),$(this.wrap).delegate(".im-ju-hide","click",function(){$(this).parents("li").find(".im-ju-list-wrap").hide(),$(".im-ju-time").removeClass("im-ju-time-state1"),$(this).text("展开").removeClass("im-ju-hide").addClass("im-ju-show"),a.scrollbarUpdate("relative")})},i.prototype.msgBindEvent=function(){function a(a,e,f){var g=a.eq(f).position().left,h=a.eq(f).width();clearTimeout(b),c.stop().animate({left:g,width:h},300),0===f&&d.msgAjaxStrategy(),1===f&&d.msgAjaxChat(),2===f&&d.msgAjaxPost(),a.eq(f).find(".im-icon-redcircle").hide(),e.eq(f).find(".im-moremsg").hide(),$("[tabname=msg]").find(".im-icon-redcircle").hide(),d.scrollbarUpdate("relative")}var b,c=$(".im-body-list-msg .redline"),d=this,e={navEle:".im-body-list-msg .im-title-tab",activeClass:"selected",contentEle:".im-body-list-msg .im-msg",triggerMode:"click",repeat:!1,callback:a};new SNS.Tab(e),$(".im-body-list-msg").on("mouseenter mouseleave click",".im-msg li",function(a){if("mouseenter"==a.type)$(this).css("backgroundColor","#f3f3f3"),$(this).find(".im-msg-answer").css("backgroundColor","#ddd");else if("mouseleave"==a.type)$(this).css("backgroundColor",""),$(this).find(".im-msg-answer").css("backgroundColor","#f3f3f3");else{var b=$(this).hasClass("unread");b&&$(this).removeClass("unread")}}),$(".im-strategy .im-moremsg").click(function(){$("[msgtabname=strategy]").trigger("click"),$(this).hide()}),$(".im-chat .im-moremsg").click(function(){$("[msgtabname=chat]").trigger("click"),$(this).hide()}),$(".im-post .im-moremsg").click(function(){$("[msgtabname=post]").trigger("click"),$(this).hide()
})},i.prototype.sysMsgBindEvent=function(){$(".im-body-list-sysmsg").on("mouseenter mouseleave click",".im-msg li",function(a){if("mouseenter"==a.type)$(this).css("backgroundColor","#f3f3f3");else if("mouseleave"==a.type)$(this).css("backgroundColor","");else{var b=$(this).hasClass("unread");if(b){$(this).removeClass("unread");var c=SNS.strToObject($(this).attr("data-action")).id,d={id:c};$.ajax({url:"/newcircle/message/setsystemread/",data:d,type:"get",cache:!1,dataType:"json",success:function(a){"0"==a.errorCode||SNS.alertBox({type:"error",tipContent:a.errorMsg})}})}}}),$(".im-sysmsg .im-moremsg").click(function(){$("[tabname=sysmsg]").trigger("click"),$(this).hide()})},i.prototype.infoAjax=function(){var a=this,b=$(".im-body-list-info");$.ajax({url:"/newcircle/bar/index/",type:"get",dataType:"json",cache:!1,beforeSend:function(){b.empty().append('<img class="centerLoading" src="//i.thsi.cn/sns/circle/newcircle/loading-page.gif" alt="" />')},success:function(c){if(0===c.errorCode){b.empty().append(c.result);var d="undefined"==typeof Gloginouturl?window.location.href:Gloginouturl,e="javascript:window.location.href='//upass.10jqka.com.cn/logout?redir="+d+"'";b.find(".dontout").attr("href",e)}else SNS.alertBox({type:"error",tipContent:c.errorMsg});a.scrollbarUpdate("relative")},error:function(){}})},i.prototype.juAjax=function(){var a=this,b=$(".im-ul");$.ajax({url:"/trace/trade/getEntrust/",type:"get",cache:!1,dataType:"json",beforeSend:function(){b.empty().append('<img class="centerLoading" src="//i.thsi.cn/sns/circle/newcircle/loading-page.gif" alt="" />')},success:function(b){var c=b.result;if(0===b.errorcode){var d=[];$.each(c,function(a){d=c[a].wtjg.split("."),c[a].wtjgbefore=d[0],c[a].wtjgafter=d[1]}),a.juRender(c),$(".im-body-list-ju .im-moremsg").hide(),a.scrollbarUpdate("relative")}else-28==b.errorcode?($(".im-ul",this.wrap).empty().html('<p class="im-kong">订阅策略当天没有交易动态</p>'),$(".im-body-list-ju .im-moremsg").hide(),a.scrollbarUpdate("relative")):SNS.alertBox({type:"error",tipContent:b.errormsg})},error:function(){b.empty().append('<p class="im-kong">数据获取失败，请稍后再试</p>')},complete:function(){b.find(".centerLoading").remove(),m(b)}})},i.prototype.juRender=function(a){var d={list:a},e=c,f=b.compile(e),g=f(d);$(".im-ul",this.wrap).empty().append(g)},i.prototype.juDetailAjax=function(a,c){var e=this;$.ajax({url:"/trace/trade/getTradeLog/",data:a,type:"get",dataType:"json",cache:!1,success:function(a){if(0===a.errorcode){var f={list:a.result},g=d,h=b.compile(g),i=h(f);$(".im-ju-list-wrap",c).empty().append(i),$(".im-ju-list-wrap",c).find("p:last").find(".im-ju-time").removeClass("im-ju-time-state2").addClass("im-ju-time-state3"),$(".im-ju-time").addClass("im-ju-time-state1"),e.scrollbarUpdate("relative")}else SNS.alertBox({type:"error",tipContent:a.errormsg})},error:function(){SNS.alertBox({type:"error",tipContent:"IM详细数据获取失败"})}})},i.prototype.msgAjaxChat=function(){var a=this,b=$(".im-chat-ul");$.ajax({url:"/newcircle/bar/groupComment/",type:"get",data:"",dataType:"json",beforeSend:function(){b.empty().append('<img class="centerLoading" src="//i.thsi.cn/sns/circle/newcircle/loading-page.gif" alt="" />'),$(".im-chat").find(".im-msg-more").hide()},success:function(c){0===c.errorCode?($(".im-title-tab[msgtabname=chat]").find(".im-icon-redcircle").hide(),b.empty().append(c.result),$(".im-chat").find(".im-msg-more").show()):b.append('<div class="im-kong">'+c.errorMsg+"</div>"),a.scrollbarUpdate("relative")},error:function(){b.empty().append('<div class="im-kong">数据获取失败，请稍后再试</div>')},complete:function(){b.find(".centerLoading").remove()}})},i.prototype.msgAjaxPost=function(){var a=this,b=$(".im-post-ul");$.ajax({url:"/newcircle/bar/circleComment/",type:"get",dataType:"json",beforeSend:function(){b.empty().append('<img class="centerLoading" src="//i.thsi.cn/sns/circle/newcircle/loading-page.gif" alt="" />'),$(".im-post").find(".im-msg-more").hide()},success:function(c){0===c.errorCode?($(".im-title-tab[msgtabname=post]").find(".im-icon-redcircle").hide(),b.empty().append(c.result),$(".im-post").find(".im-msg-more").show()):b.append('<div class="im-kong">'+c.errorMsg+"</div>"),a.scrollbarUpdate("relative")},error:function(){b.empty().append('<div class="im-kong">数据获取失败，请稍后再试</div>')},complete:function(){b.find(".centerLoading").remove()}})},i.prototype.msgAjaxSys=function(){var a=this,b=$(".im-sysmsg-ul");$.ajax({url:"/newcircle/bar/system/",type:"get",data:"",dataType:"json",beforeSend:function(){b.empty().append('<img class="centerLoading" src="//i.thsi.cn/sns/circle/newcircle/loading-page.gif" alt="" />'),$(".im-sysmsg").find(".im-msg-more").hide()},success:function(c){0===c.errorCode?(b.empty().append(c.result),$(".im-sysmsg").find(".im-msg-more").show()):b.empty().append('<div class="im-kong">'+c.errorMsg+"</div>"),a.scrollbarUpdate("relative")},error:function(){b.append('<div class="im-kong">数据获取失败，请稍后再试</div>')},complete:function(){b.find(".centerLoading").remove()}})},i.prototype.Around=function(){var a=this;setTimeout(function(){a.msgAround(),a.Around()},5e4)},i.prototype.msgAround=function(a){var b=this,c={};a&&(c={nickname:1}),$.ajax({url:"/newcircle/message/getunread/",type:"get",data:c,dataType:"json",success:function(c){if(0===c.errorCode){var d=c.result,e=parseInt(d.rewardnum);e>0&&new g(e),a&&$("[tabname=info] .im-block-title").text(d.nickname),d.ace&&b.wrap.find("[tabname=ju]").find(".im-icon-redcircle").show(),d.fans&&b.wrap.find(".im-fans").find(".im-icon-redcircle").show(),d.system&&b.wrap.find("[tabname=sysmsg]").find(".im-icon-redcircle").show(),(d.comment||d.greplynum||d.strategycomment)&&(b.wrap.find("[tabname=msg]").find(".im-icon-redcircle").show(),d.greplynum&&b.wrap.find("[msgtabname=chat]").find(".im-icon-redcircle").show(),d.comment&&b.wrap.find("[msgtabname=post]").find(".im-icon-redcircle").show(),d.strategycomment&&b.wrap.find("[msgtabname=strategy]").find(".im-icon-redcircle").show(),$("[tabname=msg]").hasClass("cur-block")&&("block"==$(".im-strategy").css("display")&&$(".im-strategy").find(".im-moremsg").show(),"block"==$(".im-chat").css("display")&&$(".im-chat").find(".im-moremsg").show(),"block"==$(".im-post").css("display")&&$(".im-post").find(".im-moremsg").show())),d.chatnum&&parseInt(d.chatnum)>0&&i.touguAIObj.personReply(parseInt(d.chatnum))}},error:function(){$("[tabname=info] .im-block-title").text(SNS.Cookies.get("u_name"))}})},i.prototype.visitLog=function(){var a=f.get("newcircle-visitLog"),b={logs:[]};if(a){b=JSON.parse(a);for(var c=b.logs,d=[],e=0;e<c.length;e++)d.push("<li>",'<a href="'+c[e].url+'" class="im-history-link">'+c[e].name+"</a>","</li>");$(".im-history-ol").empty().append(d.join(""))}else $(".visitLogsTitle").hide()},i.prototype.ieFix=function(){var a=document.all?!0:!1;a&&(j()&&k(),SNS.isIE6&&l())},i.prototype.setViewport=function(){var a=$(window).height(),b=$(".header-wrap").outerHeight();$(".im-wrap").css({height:a-b,top:b}),$(".im-wrap .viewport").css("height",a-b)},i.prototype.msgAjaxStrategy=function(){var a=this,b=$(".im-strategy-ul");$.ajax({url:"/newcircle/bar/strategyComment/",type:"get",data:"",dataType:"json",beforeSend:function(){b.empty().append('<img class="centerLoading" src="//i.thsi.cn/sns/circle/newcircle/loading-page.gif" alt="" />'),$(".im-strategy").find(".im-msg-more").hide()},success:function(c){0===c.errorCode?($(".im-title-tab[msgtabname=strategy]").find(".im-icon-redcircle").hide(),b.empty().append(c.result),c.result?$(".im-strategy").find(".im-msg-more").show():b.append('<div class="im-kong">没有数据</div>')):b.append('<div class="im-kong">'+c.errorMsg+"</div>"),a.scrollbarUpdate("relative")},error:function(){b.empty().append('<div class="im-kong">数据获取失败，请稍后再试</div>')},complete:function(){b.find(".centerLoading").remove()}})},i}),define("common",["usercard","im/im","store"],function(a,b,c){function d(){e(),"undefined"==typeof $("body").attr("data-noim")&&new b,f(),g()}function e(){$("body").click(function(a){var b=$(a.target);if("login"==b.attr("data-login")&&!SNS.getUserid()){TA.log({id:"pcpublic_login"});var c=b.attr("data-redir");return new SNS.showLoginBox(c),!1}});var a=window.location.search;a.indexOf("showlogin=1")>-1&&(SNS.getUserid()||SNS.showLoginBox())}function f(){if(0===$(".forbidAlertPage").length)return!1;var a=$(".forbidAlertPage").attr("data-forbid");if(!a||""===$(".forbidAlertPage").attr("data-forbid"))return!1;var b='<div class="fbd-container"><div class="fbd-box"><div class="fbd-head"><div class="fbd-head-ct clearfix"><div class="fl fbd-head-icon"></div><div class="fr fbd-head-txt">警告</div></div></div><div class="fbd-main"><div class="fbd-content">'+a+'</div><div class="fbd-btn-box"><a href="//t.10jqka.com.cn" class="redbg cfff btn fbd-btn">返回首页</a></div></div></div></div>',c={data:{dialogClass:"",newTpl:b,width:509},effect:{showStyle:"",effectDuration:1e3},showMask:"true",afershowCallback:function(a){a.find(".ui-dialog-close").remove()}};new SNS.Dialog(c)}function g(){$("body").on("click","._pdf_",function(){var a=$(this).attr("data-pcurl");a&&window.open(a)})}function h(){$("body").on("click",".flashList,.flashArt",function(){var a=$(this).attr("data-statid"),b={};a?(a.indexOf("=")>-1?b.unparam(a):b.id=a,TA.log({id:b.id,fid:b.fid})):TA.log({id:"c_c_index_zbzxfw",fid:"c_c_zbzxfw"})})}$(document).ready(function(){d(),h(),window.store=c})});